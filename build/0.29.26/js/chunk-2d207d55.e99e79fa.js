(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d207d55"],{a1e4:function(t,e,a){"use strict";a.r(e);a("ac1f"),a("841c"),a("b0c0");var s=function(){var t=this,e=t._self._c;return e("div",[e("breadcrumb",[e("breadcrumb-plugin"),e("breadcrumb-pin-point"),e("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t._f("uppercase")(t.$t("report"))))])],1),e("tab-menu"),e("div",{staticClass:"row"},[e("p-block",{attrs:{title:t.$t("performance report"),header:!0}},[e("p-form-row",{attrs:{label:t.$t("date")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-date-range-picker",{attrs:{id:"date",name:"date"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)]),e("p-form-row",{attrs:{id:"branch",name:"branch",label:t.$t("branch")},model:{value:t.branch,callback:function(e){t.branch=e},expression:"branch"}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("span",{staticClass:"select-link",on:{click:function(e){return t.$refs.branch.open()}}},[t._v(" "+t._s(t._f("uppercase")(t.branchName||t.$t("select")))+" ")])])]),e("p-form-row",[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("button",{staticClass:"btn btn-primary btn-sm mr-5",on:{click:t.search}},[t._v(" Search ")]),e("button",{staticClass:"btn btn-primary btn-sm mr-5",on:{click:function(e){return t.$refs.target.show(t.date.start,t.date.end)}}},[t._v(" Set Target ")]),e("button",{staticClass:"btn btn-primary btn-sm mr-5",on:{click:t.toggleColor}},[t._v(" Highlight ")]),e("button",{staticClass:"btn btn-sm btn-primary",attrs:{disabled:t.isExporting,type:"submit"},on:{click:t.exportData}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isExporting,expression:"isExporting"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" Export ")]),e("ul",{directives:[{name:"show",rawName:"v-show",value:t.downloadFiles,expression:"downloadFiles"}]},t._l(t.downloadFiles,(function(a,s){return e("li",{key:s},[e("a",{attrs:{href:a.url,download:""}},[t._v(t._s(a.name))]),t._v(" (expired in 24 hour) ")])})),0)])]),e("p-block-inner",{attrs:{"is-loading":t.isLoading}},[e("div",{staticClass:"table-responsive"},[e("p-table",{attrs:{"is-bordered":!0}},[e("tr",{attrs:{slot:"p-head"},slot:"p-head"},[e("th",{staticClass:"text-center",attrs:{colspan:2}}),e("th",{staticClass:"text-center",attrs:{colspan:9}},[t._v(" "+t._s(t.dateView)+" ")]),e("th",{staticClass:"text-center",attrs:{colspan:t.items.length}},[t._v(" "+t._s(t.dateView)+" ")])]),e("tr",{attrs:{slot:"p-head"},slot:"p-head"},[e("th",{attrs:{colspan:"2"}}),e("th",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful},attrs:{colspan:"3"}},[t._v(" Target ")]),e("th",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful},attrs:{colspan:"3"}},[t._v(" Actual ")]),e("th",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful},attrs:{colspan:"3"}},[t._v(" Actual (%) ")]),e("th",{staticClass:"text-center",attrs:{colspan:t.items.length}},[t._v(" Item Sold ")])]),e("tr",{attrs:{slot:"p-head"},slot:"p-head"},[e("th",{staticClass:"text-center",staticStyle:{"min-width":"50px"}},[t._v(" NO ")]),e("th",{staticClass:"text-center",staticStyle:{"min-width":"100px"}},[t._v(" Name ")]),e("th",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" Call ")]),e("th",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" EC ")]),e("th",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" Value ")]),e("th",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" Call ")]),e("th",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" EC ")]),e("th",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" Value ")]),e("th",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" Call ")]),e("th",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" EC ")]),e("th",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful},staticStyle:{"min-width":"50px"}},[t._v(" Value ")]),t._l(t.items,(function(a,s){return e("th",{key:s,staticClass:"text-center",staticStyle:{"min-width":"100px"}},[t._v(" "+t._s(a.name)+" ")])}))],2),t._l(t.reports,(function(a,s){return e("tr",{key:s,attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticClass:"text-center"},[t._v(" "+t._s(s+1)+" ")]),e("td",{staticClass:"text-center"},[t._v(" "+t._s(a.first_name)+" "+t._s(a.last_name)+" ")]),e("td",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful}},[t._v(" "+t._s(a.target_call||0)+" ")]),e("td",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful}},[t._v(" "+t._s(a.target_effective_call||0)+" ")]),e("td",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(a.target_value||0))+" ")]),e("td",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful}},[t._v(" "+t._s(a.call||0)+" ")]),e("td",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful}},[t._v(" "+t._s(a.effective_call||0)+" ")]),e("td",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(a.value||0))+" ")]),e("td",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(t.percentage(a.call,a.target_call)))+"% ")]),e("td",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(t.percentage(a.effective_call,a.target_effective_call)))+"% ")]),e("td",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(a.value/a.target_value*100))+"% ")]),t._l(t.items,(function(s,r){return e("td",{key:r,staticClass:"text-center"},[t._v(" "+t._s(t._f("numberFormat")(t.getItemSoldQty(s.id,a.items)))+" ")])}))],2)})),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticClass:"text-center",attrs:{colspan:"2"}},[t._v(" "+t._s(t._f("titlecase")(t.$t("total")))+" ")]),e("td",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful}},[t._v(" "+t._s(t.dataSet.totals.target_call||0)+" ")]),e("td",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful}},[t._v(" "+t._s(t.dataSet.totals.target_effective_call||0)+" ")]),e("td",{staticClass:"text-center",class:{"bg-success text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(t.dataSet.totals.target_value||0))+" ")]),e("td",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful}},[t._v(" "+t._s(t.dataSet.totals.call||0)+" ")]),e("td",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful}},[t._v(" "+t._s(t.dataSet.totals.effective_call||0)+" ")]),e("td",{staticClass:"text-center",class:{"bg-danger text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(t.dataSet.totals.value||0))+" ")]),e("td",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(t.percentage(t.dataSet.totals.call,t.dataSet.totals.target_call)))+"% ")]),e("td",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(t.percentage(t.dataSet.totals.effective_call,t.dataSet.totals.target_effective_call)))+"% ")]),e("td",{staticClass:"text-center",class:{"bg-primary text-white":t.isColorful}},[t._v(" "+t._s(t._f("numberFormat")(t.dataSet.totals.value/t.dataSet.totals.target_value*100))+"% ")]),t._l(t.items,(function(a,s){return e("td",{key:s,staticClass:"text-center"},[t._v(" "+t._s(t._f("numberFormat")(t.getItemSoldQty(a.id,t.dataSet.totals.items)))+" ")])}))],2)],2)],1)])],1)],1),e("target-modal",{ref:"target",attrs:{id:"target",title:"Target"}}),e("m-branch",{ref:"branch",on:{choosen:t.chooseBranch}})],1)},r=[],i=a("5530"),l=(a("7db0"),a("d3b7"),a("f216")),n=function(){var t=this,e=t._self._c;return e("div",[e("form",{staticClass:"row",on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[e("p-modal",{ref:"target",attrs:{id:t.id,"is-loading":t.isLoading,title:t._f("uppercase")("Target")}},[e("template",{slot:"content"},[e("p-form-row",{attrs:{id:"date",name:"date",label:t.$t("period")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-date-picker",{attrs:{id:"date",name:"date",type:"date"},on:{input:t.changeDate},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1)]),e("p-table",[e("tr",{directives:[{name:"show",rawName:"v-show",value:t.targets.length>0,expression:"targets.length > 0"}],staticClass:"bg-info-light",attrs:{slot:"p-head"},slot:"p-head"},[e("th",[t._v("Sales")]),e("th",[t._v("Call")]),e("th",[t._v("Effective Call")]),e("th",[t._v("Value")])]),t._l(t.form.targets,(function(a){return e("tr",{key:a.id,attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticClass:"no-wrap"},[t._v(" "+t._s(a.first_name)+" "+t._s(a.last_name)+" ")]),e("td",[e("p-form-number",{attrs:{id:"call","is-text-right":!0,name:"call",errors:t.form.errors.get("call")},on:{errors:function(e){return t.form.errors.set("call",null)}},model:{value:a.call,callback:function(e){t.$set(a,"call",e)},expression:"target.call"}})],1),e("td",[e("p-form-number",{attrs:{id:"effective-call","is-text-right":!0,name:"effectiveCall",errors:t.form.errors.get("effectiveCall")},on:{errors:function(e){return t.form.errors.set("effectiveCall",null)}},model:{value:a.effective_call,callback:function(e){t.$set(a,"effective_call",e)},expression:"target.effective_call"}})],1),e("td",[e("p-form-number",{attrs:{id:"value","is-text-right":!0,name:"value",errors:t.form.errors.get("value")},on:{errors:function(e){return t.form.errors.set("value",null)}},model:{value:a.value,callback:function(e){t.$set(a,"value",e)},expression:"target.value"}})],1)])}))],2)],1),e("template",{slot:"footer"},[e("button",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"btn btn-primary",attrs:{type:"submit",disabled:t.isSaving}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("save")))+" ")]),e("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{disabled:t.isSaving,type:"button"},on:{click:t.close}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("close")))+" ")])])],2)],1)])},o=[],c=(a("159b"),a("b7ae")),d=a("2f62"),u={props:{id:{type:String,required:!0}},data:function(){return{form:new c["a"]({date:this.$moment(),targets:[]}),date:this.$moment(),dateFrom:this.$moment(),dateTo:this.$moment(),isLoading:!1,isSaving:!1}},computed:Object(i["a"])({},Object(d["c"])("pluginPinPointSalesVisitationTarget",["targets"])),methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(d["b"])("pluginPinPointSalesVisitationTarget",{get:"get",create:"create"})),Object(d["b"])("pluginPinPointReportPerformance",{getReport:"get"})),{},{show:function(t,e){var a=this;this.isLoading=!0,this.dateFrom=t,this.dateTo=e,this.get({params:{date:this.date}}).then((function(t){a.form=new c["a"]({date:a.$moment(),targets:t.data}),a.form.targets.forEach((function(t){t.date=a.date,t.value=parseFloat(t.value)})),a.isLoading=!1}),(function(t){a.isLoading=!1,a.$notification.error("Create failed",t.message)})),this.$refs.target.show()},close:function(){this.form.reset(),this.$refs.target.close()},onSubmit:function(){var t=this;this.isSaving=!0,this.create(this.form).then((function(e){t.$notification.success("Set target success"),t.isSaving=!1,t.form.reset(),t.getReport({params:{date_from:t.dateFrom,date_to:t.dateTo}})}),(function(e){t.$notification.error("Set target failed",e.message),t.isSaving=!1}))},changeDate:function(){var t=this;this.isLoading=!0,this.get({params:{date:this.date}}).then((function(e){t.form=new c["a"]({date:t.$moment(),targets:e.data}),t.form.targets.forEach((function(e){e.date=t.date,e.value=parseFloat(e.value)})),t.isLoading=!1}),(function(e){t.isLoading=!1,t.$notification.error(e.message)}))}})},m=u,f=a("2877"),h=Object(f["a"])(m,n,o,!1,null,null,null),g=h.exports,b=a("5ae6"),p=a("bc27"),_=a("8e1a"),v={components:{TabMenu:l["a"],TargetModal:g,Breadcrumb:b["a"],BreadcrumbPlugin:p["a"],BreadcrumbPinPoint:_["a"]},data:function(){return{date:{start:this.$moment().format("YYYY-MM-DD 00:00:00"),end:this.$moment().format("YYYY-MM-DD 23:59:59")},branch:{},branchId:null,branchName:"",isLoading:!1,isExporting:!1,isColorful:!1,downloadFiles:[]}},computed:Object(i["a"])(Object(i["a"])({},Object(d["c"])("pluginPinPointReportPerformance",["reports","items","dataSet"])),{},{dateView:function(){return this.date.start==this.date.end?this.$moment(this.date.start).format("D MMM Y"):this.date.start<this.date.end?this.$moment(this.date.start).format("D MMM Y")+" - "+this.$moment(this.date.end).format("D MMM Y"):"Invalid date"}}),created:function(){this.get({params:{date_from:this.date.start,date_to:this.date.end}})},methods:Object(i["a"])(Object(i["a"])({},Object(d["b"])("pluginPinPointReportPerformance",["get","export"])),{},{percentage:function(t,e){var a=t/e*100;return a>=100?100:a},getItemSoldQty:function(t,e){var a=e.find((function(e){return e.item_id===t}));return a?a.quantity:0},toggleColor:function(){this.isColorful=!this.isColorful},chooseBranch:function(t){this.branchId=t.id,this.branchName=t.name},search:function(){var t=this;this.isLoading=!0,this.get({params:{date_from:this.$moment(this.date.start).format("YYYY-MM-DD 00:00:00"),date_to:this.$moment(this.date.end).format("YYYY-MM-DD 23:59:59"),branch_id:this.branchId}}).then((function(e){t.isLoading=!1}),(function(e){t.$notification.error(e.message),t.isLoading=!1}))},exportData:function(){var t=this;this.isExporting=!0,this.export({date_from:this.$moment(this.date.start).format("YYYY-MM-DD 00:00:00"),date_to:this.$moment(this.date.end).format("YYYY-MM-DD 23:59:59"),branch_id:this.branchId}).then((function(e){t.isExporting=!1,t.downloadFiles=e.data.files})).catch((function(e){t.isExporting=!1,console.log(e)}))}})},x=v,C=Object(f["a"])(x,s,r,!1,null,null,null);e["default"]=C.exports}}]);
//# sourceMappingURL=chunk-2d207d55.e99e79fa.js.map
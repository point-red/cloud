(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0e8463ce"],{"55f8":function(t,e,r){"use strict";r("e5d4")},"68db9":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t._self._c;return e("div",[e("form",{on:{submit:function(e){return e.preventDefault(),t.submitForm.apply(null,arguments)}}},[e("div",{staticClass:"row"},[e("p-block",[e("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[e("p-form-row",{attrs:{id:"started_at",name:"started_at",required:!0,label:t._f("uppercase")(t.$t("start")),"show-asterisk-on-required":!0}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-date-time-picker",{attrs:{id:"started_at",disabled:t.isSaving,name:"started_at"},model:{value:t.form.started_at,callback:function(e){t.$set(t.form,"started_at",e)},expression:"form.started_at"}})],1)]),e("p-form-row",{attrs:{id:"ended_at",name:"ended_at",label:t.$t("end"),required:!0,"show-asterisk-on-required":!0}},[e("div",{staticClass:"col-lg-9 d-sm-flex",attrs:{slot:"body"},slot:"body"},[e("p-date-time-picker",{attrs:{id:"ended_at",disabled:t.isSaving,name:"ended_at"},model:{value:t.form.ended_at,callback:function(e){t.$set(t.form,"ended_at",e)},expression:"form.ended_at"}}),e("div",{staticClass:"pl-sm-3 mt-3 mt-sm-0"},[e("button",{staticClass:"btn-duration",attrs:{type:"button"},on:{click:function(e){return t.setDuration(30)}}},[t._v(" 30"),e("br"),t._v("min ")]),e("button",{staticClass:"btn-duration",attrs:{type:"button"},on:{click:function(e){return t.setDuration(45)}}},[t._v(" 45"),e("br"),t._v("min ")]),e("button",{staticClass:"btn-duration",attrs:{type:"button"},on:{click:function(e){return t.setDuration(60)}}},[t._v(" 60"),e("br"),t._v("min ")]),e("button",{staticClass:"btn-duration",attrs:{type:"button"},on:{click:function(e){return t.setDuration(90)}}},[t._v(" 90"),e("br"),t._v("min ")]),e("button",{staticClass:"btn-duration",attrs:{type:"button"},on:{click:function(e){return t.setDuration(120)}}},[t._v(" 120"),e("br"),t._v("min ")])])],1)]),e("google-auth"),e("p-form-row",{attrs:{label:t.$t("study subject"),required:!0,"show-asterisk-on-required":!0}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("select-subject",{attrs:{disabled:t.isSaving,errors:t.pointForm.errors.get("subject_id")},on:{errors:function(e){return t.pointForm.errors.set("subject_id",null)}},model:{value:t.form.subject_id,callback:function(e){t.$set(t.form,"subject_id",e)},expression:"form.subject_id"}})],1)]),e("p-form-row",{attrs:{label:t.$t("photo"),"show-asterisk-on-required":!0,errors:t.pointForm.errors.get("photo")},on:{errors:function(e){return t.pointForm.errors.set("photo",null)}}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-form-file",{ref:"photo",attrs:{id:"photo",name:"photo",accept:"image/*",disabled:t.isSaving},on:{fileChanged:t.photoUploaded}})],1)]),e("p-form-row",{attrs:{label:t.$t("voice note"),errors:t.pointForm.errors.get("audio")},on:{errors:function(e){return t.pointForm.errors.set("audio",null)}}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-form-file",{ref:"audio",attrs:{id:"audio",name:"audio",accept:"audio/*",disabled:t.isSaving},on:{fileChanged:t.audioUploaded}})],1)]),e("p-form-row",{attrs:{label:t.$t("video"),errors:t.pointForm.errors.get("video")},on:{errors:function(e){return t.pointForm.errors.set("video",null)}}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-form-file",{ref:"video",attrs:{id:"video",name:"video",accept:"video/*",disabled:t.isSaving},on:{fileChanged:t.videoUploaded}})],1)]),e("p-form-row",{attrs:{id:"institution",name:"institution",disabled:t.isSaving,label:t.$t("institution"),errors:t.pointForm.errors.get("institution")},on:{errors:function(e){return t.pointForm.errors.set("institution",null)}},model:{value:t.form.institution,callback:function(e){t.$set(t.form,"institution",e)},expression:"form.institution"}}),e("p-form-row",{attrs:{id:"teacher",name:"teacher",disabled:t.isSaving,label:t.$t("teacher"),errors:t.pointForm.errors.get("teacher")},on:{errors:function(e){return t.pointForm.errors.set("teacher",null)}},model:{value:t.form.teacher,callback:function(e){t.$set(t.form,"teacher",e)},expression:"form.teacher"}}),e("p-form-row",[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("div",{staticClass:"mb-2 d-flex font-size-lg text-primary"},[e("div",{staticClass:"mr-2"},[e("i",{staticClass:"fa fa-book"})]),e("div",[e("a",{staticStyle:{"text-decoration":"underline"},attrs:{href:"https://docs.google.com/spreadsheets/d/11TVngjUsDSP3wPCZkO2B6jKOGNvPSlu-7UdYHb_SzbU/edit?usp=sharing",target:"_blank",rel:"noopener noreferrer"}},[t._v(" "+t._s(t._f("titlecase")(t.$t("access topics library here")))+" ")])])])])]),e("p-form-row",{attrs:{id:"competency",name:"competency",disabled:t.isSaving,label:t.$t("competency"),required:!0,"show-asterisk-on-required":!0,errors:t.pointForm.errors.get("competency")},on:{errors:function(e){return t.pointForm.errors.set("competency",null)}},model:{value:t.form.competency,callback:function(e){t.$set(t.form,"competency",e)},expression:"form.competency"}}),e("p-form-row",{attrs:{id:"learning_goals",name:"learning_goals",disabled:t.isSaving,label:t.$t("learning goals"),required:!0,"show-asterisk-on-required":!0,errors:t.pointForm.errors.get("learning_goals")},on:{errors:function(e){return t.pointForm.errors.set("learning_goals",null)}},model:{value:t.form.learning_goals,callback:function(e){t.$set(t.form,"learning_goals",e)},expression:"form.learning_goals"}}),e("p-form-row",{attrs:{id:"activities",name:"activities",disabled:t.isSaving,label:t.$t("activities"),errors:t.pointForm.errors.get("activities")},on:{errors:function(e){return t.pointForm.errors.set("activities",null)}},model:{value:t.form.activities,callback:function(e){t.$set(t.form,"activities",e)},expression:"form.activities"}}),e("p-form-row",{attrs:{id:"grade",name:"grade",label:t.$t("grade")+" (0-100)",errors:t.pointForm.errors.get("grade")},on:{errors:function(e){return t.pointForm.errors.set("grade",null)}}},[e("div",{staticClass:"col-1",attrs:{slot:"body"},slot:"body"},[e("p-form-number",{attrs:{id:"grade",name:"grade","is-text-right":!1,disabled:t.isSaving,label:t.$t("grade"),max:100},model:{value:t.form.grade,callback:function(e){t.$set(t.form,"grade",e)},expression:"form.grade"}})],1)]),e("p-form-row",{attrs:{id:"behavior",name:"behavior",label:t.$t("behavior"),required:!0,"show-asterisk-on-required":!0}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-select",{attrs:{id:"behavior",disabled:t.isSaving,name:"behavior",options:t.behaviorList,errors:t.pointForm.errors.get("behavior")},on:{errors:function(e){return t.pointForm.errors.set("behavior",null)}},model:{value:t.form.behavior,callback:function(e){t.$set(t.form,"behavior",e)},expression:"form.behavior"}})],1)]),e("p-form-row",{attrs:{id:"remarks",name:"remarks",disabled:t.isSaving,label:t.$t("remarks"),errors:t.pointForm.errors.get("remarks")},on:{errors:function(e){return t.pointForm.errors.set("remarks",null)}},model:{value:t.form.remarks,callback:function(e){t.$set(t.form,"remarks",e)},expression:"form.remarks"}}),e("div",[e("span",{staticClass:"text-danger"},[t._v("*")]),t._v(" "+t._s(t._f("capitalize")(t.$t("required")))+" ")]),e("div",{staticClass:"text-right mb-4"},[e("button",{staticClass:"btn btn-sm btn-light mr-2",attrs:{type:"button",disabled:t.isSaving},on:{click:t.cancel}},[t._v(" "+t._s(t._f("uppercase")(t.$t("cancel")))+" ")]),e("button",{staticClass:"btn btn-sm btn-secondary mr-2",attrs:{type:"button",disabled:t.isSaving},on:{click:t.saveAsDraft}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("draft")))+" ")]),e("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"submit",disabled:t.isSaving},on:{click:t.onSubmit}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("save")))+" ")])])],1)])],1)])])},i=[],a=r("5530"),n=(r("d3b7"),r("ac1f"),r("5319"),r("159b"),r("b64b"),r("bb36")),s=r("b7ae"),l=function(){var t=this,e=t._self._c;return e("p-form-row",{attrs:{label:""}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t.isLoading?e("div",{staticClass:"font-size-lg badge badge-warning"},[t._v(" "+t._s(t._f("titlecase")(t.$t("checking google drive connection")))+" ")]):t.hasToken?[e("div",{staticClass:"font-size-lg badge badge-primary"},[t._v(" "+t._s(t._f("titlecase")(t.$t("google drive authorized")))+" ")]),e("button",{staticClass:"btn btn-sm btn-secondary ml-2",staticStyle:{"padding-top":"0","padding-bottom":"0",height:"22px"},attrs:{type:"button",disabled:t.isSaving},on:{click:t.unlinkGoogleDrive}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t.$t("unlink"))+" ")])]:e("button",{staticClass:"btn btn-sm btn-primary mr-2",attrs:{type:"button"},on:{click:t.openWindow}},[t._v(" "+t._s(t._f("titlecase")(t.$t("authorize google drive")))+" ")])],2)])},d=[],u={name:"PluginStudyGoogleAuth",data:function(){return{isLoading:!0,isSaving:!1,hasToken:!1,authUrl:"",myInterval:null}},created:function(){this.getOauthToken()},beforeDestroy:function(){clearInterval(this.myInterval)},methods:{getOauthToken:function(){var t=this;n["a"].get("oauth/login/google/drive").then((function(e){e.data.authenticated&&(t.hasToken=!0,clearInterval(t.myInterval)),t.authUrl=e.data.auth_url})).catch((function(e){t.$notification.error(e.data.message)})).finally((function(){t.isLoading=!1}))},openWindow:function(){var t=this;window.open(this.authUrl,"newwindow","width=400,height=600"),setTimeout((function(){t.myInterval=setInterval(t.getOauthToken,1e3)}),7e3)},unlinkGoogleDrive:function(){var t=this;this.isSaving=!0,n["a"].delete("oauth/login/google/drive").then((function(){t.hasToken=!1})).catch((function(e){t.$notification.error(e.data.message)})).finally((function(){t.isSaving=!1}))}}},c=u,m=r("2877"),f=Object(m["a"])(c,l,d,!1,null,null,null),b=f.exports,p=r("ead7"),v={name:"PluginStudySheetCreate",components:{SelectSubject:p["a"],GoogleAuth:b},beforeRouteLeave:function(t,e,r){this.confirmStayInDirtyForm()?r(!1):r()},data:function(){return{isSaving:!1,form:{started_at:this.$moment().startOf("hour").format("YYYY-MM-DD HH:mm:ss"),ended_at:this.$moment().startOf("hour").add(30,"minutes").format("YYYY-MM-DD HH:mm:ss"),photo:null,audio:null,video:null,subject_id:null,institution:null,teacher:null,competency:null,learning_goals:null,activities:null,grade:null,behavior:null,remarks:null,is_draft:!1},isSaved:!1,pointForm:new s["a"]({}),behaviorList:[{id:"A",label:"A - Excellent"},{id:"B",label:"B - Good"},{id:"C",label:"C - Need Improvement"}]}},computed:{formIsDirty:function(){return!this.isSaved&&(this.form.photo||this.form.audio||this.form.video||this.form.subject_id||this.form.institution||this.form.teacher||this.form.competency||this.form.learning_goals||this.form.activities||this.form.grade||this.form.behavior||this.form.remarks)}},created:function(){this.pointForm=new s["a"](this.form),window.addEventListener("beforeunload",this.beforeWindowUnload)},beforeDestroy:function(){window.removeEventListener("beforeunload",this.beforeWindowUnload)},methods:{onSubmit:function(){var t=this;this.isSaving=!0;var e={"Content-Type":"multipart/form-data"};n["a"].post("/plugin/study/sheet",this.getFormData(),{headers:e}).then((function(e){var r=t.$t("data has been saved"),o=t.$options.filters.capitalize(r);t.$notification.success(o),t.isSaved=!0,t.form.is_draft?t.$router.replace({name:"PluginStudySheetDraft"}):t.$router.replace({name:"PluginStudySheetShow",params:{id:e.data.id}})})).catch((function(e){422===e.status?t.pointForm.errors.record(e.data.errors):t.$notification.error(e.data.message)})).finally((function(){t.isSaving=!1}))},saveAsDraft:function(){this.form.is_draft=!0,this.onSubmit()},getFormData:function(){var t=new FormData,e=Object(a["a"])(Object(a["a"])({},this.form),{},{started_at:new Date(this.form.started_at).toISOString(),ended_at:new Date(this.form.ended_at).toISOString()});return Object.keys(e).forEach((function(r){!1===e[r]||!0===e[r]?t.append(r,!1===e[r]?0:1):e[r]&&t.append(r,e[r])})),t},cancel:function(){this.pointForm.reset(),this.form=Object(a["a"])({},this.point),this.$router.replace({name:"PluginStudySheetIndex"})},confirmLeave:function(){return window.confirm("Do you really want to leave? you have unsaved changes!")},confirmStayInDirtyForm:function(){return this.formIsDirty&&!this.confirmLeave()},beforeWindowUnload:function(t){this.confirmStayInDirtyForm()&&(t.preventDefault(),t.returnValue="")},setDuration:function(t){var e=this.$moment(this.form.started_at),r=e.add(t,"minutes");this.form.ended_at=r.format("YYYY-MM-DD HH:mm:ss")},photoUploaded:function(t){this.form.photo=t},audioUploaded:function(t){this.form.audio=t},videoUploaded:function(t){this.form.video=t}}},h=v,g=(r("55f8"),Object(m["a"])(h,o,i,!1,null,"604e5b41",null));e["default"]=g.exports},e5d4:function(t,e,r){},ead7:function(t,e,r){"use strict";var o=function(){var t=this,e=t._self._c;return e("p-select",{attrs:{id:"subject",name:"subject",options:t.subjects,"label-field":"name",errors:t.errors},on:{errors:function(e){return t.$emit("errors")}},model:{value:t.modelValue,callback:function(e){t.modelValue=e},expression:"modelValue"}})},i=[],a=(r("a9e3"),r("bb36")),n={name:"PluginStudySelectSubject",props:{value:{type:[String,Number],default:0},errors:{type:Array,default:function(){return[]}}},data:function(){return{subjects:[]}},computed:{modelValue:{get:function(){return this.value},set:function(t){this.$emit("input",t)}}},created:function(){this.getSubjects()},methods:{getSubjects:function(){var t=this,e={sort_by:"name"};a["a"].get("/plugin/study/subject",{params:e}).then((function(e){t.subjects=e.data.data})).catch((function(e){t.$notification.error(e.data.message)}))}}},s=n,l=r("2877"),d=Object(l["a"])(s,o,i,!1,null,null,null);e["a"]=d.exports}}]);
//# sourceMappingURL=chunk-0e8463ce.894db335.js.map
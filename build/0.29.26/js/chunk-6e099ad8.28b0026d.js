(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6e099ad8"],{"26e9":function(e,t,r){"use strict";var a=function(){var e=this,t=e._self._c;return t("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/plugin/play-book"}},[e._v(" "+e._s(e._f("uppercase")(e.$t("play book")))+" ")])},s=[],o=r("2877"),n={},c=Object(o["a"])(n,a,s,!1,null,null,null);t["a"]=c.exports},"3c4c":function(e,t,r){},"4ac4":function(e,t,r){"use strict";r.r(t);r("b0c0"),r("14d9");var a=function(){var e=this,t=e._self._c;return t("div",[t("breadcrumb",[t("breadcrumb-plugin"),t("breadcrumb-play-book"),t("breadcrumb-procedure"),t("span",{staticClass:"breadcrumb-item active"},[e._v(e._s(e._f("uppercase")(e.form.code||"Show")))])],1),t("div",{staticClass:"row"},[t("p-block",[t("p-block-inner",{attrs:{"is-loading":e.isLoading}},[t("div",{staticClass:"d-flex justify-content-between align-items-center"},[e.form.approved_at?t("h5",{staticClass:"my-0"},[e._v(" "+e._s(e._f("uppercase")("code"))+" ")]):t("h5",{staticClass:"my-0"},[e._v(" "+e._s(e._f("uppercase")("".concat(e.form.approval_action," submission")))+" ")]),t("div",{staticClass:"text-right"},[e.$permission.has("update play book procedure")&&e.form.approved_at?t("button",{staticClass:"btn btn-sm btn-outline-secondary mr-5",attrs:{type:"button"},on:{click:function(t){return e.$refs.modalEditProcedure.open()}}},[e._v(" "+e._s(e._f("uppercase")(e.$t("edit")))+" ")]):e._e(),e.$permission.has("delete play book procedure")&&(e.form.approved_at||e.form.declined_at)?t("button",{staticClass:"btn btn-sm btn-outline-secondary mr-5",attrs:{type:"button",disabled:e.isDeleting},on:{click:e.confirmDelete}},[t("i",{directives:[{name:"show",rawName:"v-show",value:e.isDeleting,expression:"isDeleting"}],staticClass:"fa fa-asterisk fa-spin"}),e._v(" "+e._s(e._f("uppercase")(e.$t("delete")))+" ")]):e._e(),e.form.approved_at?t("router-link",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{to:"/plugin/play-book/procedure/".concat(e.form.id,"/histories")}},[e._v(" SEE HISTORY ")]):e._e()],1),!e.$permission.has("approve play book procedure")||e.form.approval_request_to!==e.authUser.id||e.form.declined_at||e.form.approved_at?e._e():t("div",{staticClass:"text-right"},[t("button",{staticClass:"btn btn-sm btn-secondary mr-5",attrs:{type:"button"},on:{click:function(t){return e.$refs.modalDeclineProcedure.open()}}},[e._v(" "+e._s(e._f("uppercase")(e.$t("decline")))+" ")]),t("button",{staticClass:"btn btn-sm btn-secondary mr-5",attrs:{type:"button"},on:{click:e.approve}},[e._v(" "+e._s(e._f("uppercase")(e.$t("approve")))+" ")])])]),t("hr"),e.updateSucess?t("div",{staticClass:"alert alert-success"},[e._v(" Procedure updated ")]):e._e(),e.errors?t("div",{staticClass:"alert alert-danger"},[t("strong",[e._v(e._s(e.errors.message))])]):e._e(),t("form",{staticClass:"col-lg-6",on:{submit:function(t){return t.preventDefault(),e.submit.apply(null,arguments)}}},[t("p-form-row",{attrs:{id:"code",name:"code",label:e.$t("code")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("div",{staticClass:"form-control bg-light",staticStyle:{height:"fit-content"}},[e._v(" "+e._s(e.form.code)+" ")])])]),t("p-form-row",{attrs:{id:"name",name:"name",label:e.$t("name")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("div",{staticClass:"form-control bg-light",staticStyle:{height:"fit-content"}},[e._v(" "+e._s(e.form.name)+" ")])])]),t("p-form-row",{attrs:{id:"purpose",name:"purpose",label:e.$t("purpose")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("div",{staticClass:"form-control bg-light",staticStyle:{height:"fit-content"}},[e._v(" "+e._s(e.form.purpose||"-")+" ")])])]),e.form.procedure_id?t("p-form-row",{attrs:{id:"content",name:"content",label:e.$t("content")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("div",{staticClass:"form-control bg-light",staticStyle:{height:"fit-content"}},[e._v(" "+e._s(e.form.content||"-")+" ")])])]):e._e(),t("p-form-row",{attrs:{id:"note",name:"note",label:e.$t("note")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("div",{staticClass:"form-control bg-light",staticStyle:{height:"fit-content"}},[e._v(" "+e._s(e.form.note||"-")+" ")])])])],1)]),t("hr"),t("p-block-inner",{staticClass:"mt-5",attrs:{"is-loading":e.isLoading}},[t("div",{staticClass:"d-flex align-items-center justify-content-between"},[t("div",{staticClass:"d-flex align-items-center"},[e.form.procedure_id?t("router-link",{staticClass:"btn btn-sm btn-light mr-3",attrs:{to:"/plugin/play-book/procedure/".concat(e.form.procedure_id)}},[t("i",{staticClass:"fa fa-arrow-left"})]):e._e(),t("h5",{staticClass:"my-0"},[e._v(" "+e._s(e._f("uppercase")(e.$t("content")))+" ")])],1),e.$permission.has("create play book procedure")&&e.form.approved_at?t("button",{staticClass:"btn btn-sm btn-light",on:{click:function(t){return e.$refs.modalAddProcedure.open()}}},[t("i",{staticClass:"fa fa-plus"})]):e._e()]),t("div",{staticClass:"pt-5"},[e._v(" "+e._s(e.form.procedures.length)+" "),e._l(e.form.procedures,(function(r,a){return t("procedure-code-item",{key:r.id,attrs:{i:++a,procedure:r,"with-add-button":!0,"is-parent":!0},on:{added:e.getData}})})),e.form.procedures&&e.form.procedures.length<1?t("div",[e._v(" No content. ")]):e._e()],2)])],1)],1),t("m-add-procedure",{ref:"modalAddProcedure",attrs:{"parent-id":parseInt(e.$route.params.id)},on:{added:function(t){return e.$router.push("/plugin/play-book/approval/procedure/send")}}}),t("m-edit-procedure",{ref:"modalEditProcedure",attrs:{"procedure-id":parseInt(e.$route.params.id)},on:{added:function(t){return e.$router.push("/plugin/play-book/approval/procedure/send")}}}),t("m-decline-procedure",{ref:"modalDeclineProcedure",attrs:{"procedure-id":parseInt(e.$route.params.id)},on:{added:function(t){return e.getData()}}})],1)},s=[],o=r("c7eb"),n=r("1da1"),c=r("5530"),i=(r("ac1f"),r("5319"),r("5ae6")),u=r("bc27"),d=r("26e9"),l=r("6695"),p=r("4d633"),f=r("2f62"),m={components:{Breadcrumb:i["a"],BreadcrumbPlugin:u["a"],BreadcrumbPlayBook:d["a"],BreadcrumbProcedure:l["a"],ProcedureCodeItem:p["a"]},data:function(){return{isSaving:!1,isEditMode:!1,isLoading:!1,isDeleting:!1,updateSucess:!1,form:{code:null,name:null,purpose:null,note:null,procedures:[]},errors:null}},computed:Object(c["a"])({},Object(f["c"])("auth",["authUser"])),watch:{"$route.params.id":function(){this.getData()}},mounted:function(){var e=this;this.getData().then((function(){e.form.approval_request_to!==e.authUser.id||e.form.declined_at||e.form.approved_at||("approve"===e.$route.query.action?e.approve():"reject"===e.$route.query.action&&e.$refs.modalDeclineProcedure.open())}))},methods:Object(c["a"])(Object(c["a"])({},Object(f["b"])("pluginPlayBookProcedure",["update","show","delete"])),{},{getData:function(){var e=this;return Object(n["a"])(Object(o["a"])().mark((function t(){var r,a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,r=e.$route.params.id,e.isLoading=!0,t.next=5,e.show(r);case 5:a=t.sent,e.form=Object(c["a"])({},a),t.next=11;break;case 9:t.prev=9,t.t0=t["catch"](0);case 11:return t.prev=11,e.isLoading=!1,t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,9,11,14]])})))()},approve:function(){var e=this;return Object(n["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$alert.confirm(e.$t("approve"),e.$t("are you sure you want to approve this approval?")).then(function(){var t=Object(n["a"])(Object(o["a"])().mark((function t(r){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,a=e.$route.params.id,e.isLoading=!0,t.next=5,e.$store.dispatch("pluginPlayBookProcedureApproval/approve",a);case 5:"update"===e.form.approval_action?e.$router.replace("/plugin/play-book/procedure/".concat(e.form.procedure_pending_id)):"destroy"===e.form.approval_action?e.$alert.success("Delete success","This item has been removed.").then((function(){e.$router.replace("/plugin/play-book/procedure/")})):e.getData(),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:return t.prev=10,e.isLoading=!1,t.finish(10);case 13:case"end":return t.stop()}}),t,null,[[0,8,10,13]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},submit:function(){var e=this;return Object(n["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{e.errors=null,e.isSaving=!0,e.isEditMode=!1,e.updateSucess=!0,setTimeout((function(){e.updateSucess=!1}),3e3)}catch(r){e.errors=Object(c["a"])({message:r.message},r.errors)}finally{e.isSaving=!1}case 1:case"end":return t.stop()}}),t)})))()},confirmDelete:function(){var e=this;return Object(n["a"])(Object(o["a"])().mark((function t(){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$alert.confirm(e.$t("delete"),e.$t("confirmation delete message")).then(function(){var t=Object(n["a"])(Object(o["a"])().mark((function t(r){return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isLoading=!0,e.isDeleteing=!0,t.next=5,e.delete(e.$route.params.id);case 5:e.form.declined_at?e.$router.push("/plugin/play-book/procedure"):e.$router.push("/plugin/play-book/approval/procedure/send"),t.next=10;break;case 8:t.prev=8,t.t0=t["catch"](0);case 10:return t.prev=10,e.isDeleteing=!1,e.isLoading=!1,t.finish(10);case 14:case"end":return t.stop()}}),t,null,[[0,8,10,14]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()}})},b=m,v=(r("4c63"),r("2877")),_=Object(v["a"])(b,a,s,!1,null,null,null);t["default"]=_.exports},"4c63":function(e,t,r){"use strict";r("8014")},"4d633":function(e,t,r){"use strict";r("b0c0");var a=function(){var e=this,t=e._self._c;return t("div",{class:{parent:!e.procedure.procedure_id||e.isParent}},[t("div",{staticClass:"d-flex procedure",class:{"ml-3":!e.i}},[e.i?t("div",{staticClass:"no ml-2"},[e._v(" "+e._s(e.i)+" ")]):e._e(),t("div",{staticClass:"code"},[e._m(0),t("router-link",{attrs:{to:"/plugin/play-book/procedure/".concat(e.procedure.id)}},[e._v(" "+e._s(e.procedure.code)+" ")])],1),t("div",{staticClass:"name"},[e._m(1),e._v(" "+e._s(e.procedure.name)+" ")]),t("div",{staticClass:"purpose"},[e._m(2),e._v(" "+e._s(e._f("capitalize")(e.procedure.purpose||"-"))+" ")]),e.procedure.procedure_id?t("div",{staticClass:"purpose"},[e._m(3),e._v(" "+e._s(e.procedure.content||"-")+" ")]):e._e(),t("div",{staticClass:"note"},[e._m(4),e._v(" "+e._s(e.procedure.note||"-")+" ")]),t("div",{staticClass:"action d-flex"},[e.withAddButton&&e.$permission.has("create play book procedure")?t("button",{staticClass:"btn btn-sm btn-light mr-2",on:{click:function(t){return e.$refs.modalAddProcedure.open()}}},[t("i",{staticClass:"fa fa-plus"})]):e._e(),t("router-link",{staticClass:"btn btn-sm btn-light",attrs:{title:"SEE HISTORY",to:"/plugin/play-book/procedure/".concat(e.procedure.id,"/histories")}},[t("i",{staticClass:"fa fa-history"})])],1)]),e.procedure.procedures&&e.procedure.procedures.length&&!e.noChilds?t("div",{staticClass:"procedures pl-4"},e._l(e.procedure.procedures,(function(r){return t("ProcedureCodeItem",{key:r.id,attrs:{procedure:r,"with-add-button":!!e.withAddButton},on:{added:function(t){return e.$emit("added")}}})})),1):e._e(),t("m-add-procedure",{ref:"modalAddProcedure",attrs:{"parent-id":e.procedure.id},on:{added:function(t){return e.$emit("added")}}})],1)},s=[function(){var e=this,t=e._self._c;return t("div",[t("small",{staticClass:"text-mode"},[e._v("Code")])])},function(){var e=this,t=e._self._c;return t("div",[t("small",{staticClass:"text-mode"},[e._v("Name")])])},function(){var e=this,t=e._self._c;return t("div",[t("small",{staticClass:"text-mode"},[e._v("Purpose")])])},function(){var e=this,t=e._self._c;return t("div",[t("small",{staticClass:"text-mode"},[e._v("Content")])])},function(){var e=this,t=e._self._c;return t("div",[t("small",{staticClass:"text-mode"},[e._v("Note")])])}],o=(r("a9e3"),{name:"ProcedureCodeItem",props:{i:{type:[Number,String],default:""},procedure:{type:Object,default:null},withAddButton:{type:Boolean,default:null},noChilds:{type:Boolean,default:!1},isParent:{type:Boolean,default:null}}}),n=o,c=(r("e0f8"),r("2877")),i=Object(c["a"])(n,a,s,!1,null,"777b092c",null);t["a"]=i.exports},6695:function(e,t,r){"use strict";var a=function(){var e=this,t=e._self._c;return t("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/plugin/play-book/procedure"}},[e._v(" "+e._s(e._f("uppercase")(e.$t("procedure")))+" ")])},s=[],o=r("2877"),n={},c=Object(o["a"])(n,a,s,!1,null,null,null);t["a"]=c.exports},8014:function(e,t,r){},e0f8:function(e,t,r){"use strict";r("3c4c")}}]);
//# sourceMappingURL=chunk-6e099ad8.28b0026d.js.map
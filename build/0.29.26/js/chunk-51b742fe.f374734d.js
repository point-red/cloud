(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51b742fe"],{"208e":function(t,e,a){"use strict";var s=function(){var t=this,e=t._self._c;return e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/sales"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("sales")))+" ")])},r=[],i=a("2877"),o={},n=Object(i["a"])(o,s,r,!1,null,null,null);e["a"]=n.exports},2211:function(t,e,a){"use strict";a.r(e);a("b0c0");var s=function(){var t=this,e=t._self._c;return e("div",[e("breadcrumb",[e("breadcrumb-sales"),e("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t._f("uppercase")(t.$t("sales order"))))])],1),e("sales-menu"),e("div",{staticClass:"row"},[e("p-block",[e("div",{staticClass:"card m-5 pt-10"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-4 text-center"},[e("p-form-row",{attrs:{id:"date-start",name:"date-start",label:t.$t("item"),"is-horizontal":!1}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("span",{staticClass:"select-link font-size-md",on:{click:function(e){return t.$refs.item.open()}}},[t._v(" "+t._s(t._f("uppercase")(t.item_label||t.$t("select")))+" ")])])])],1),e("div",{staticClass:"col-sm-4 text-center"},[e("p-form-row",{attrs:{id:"date-start",name:"date-start",label:t.$t("date start"),"is-horizontal":!1}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("p-date-picker",{attrs:{id:"date",name:"date",label:"date"},model:{value:t.date.start,callback:function(e){t.$set(t.date,"start",e)},expression:"date.start"}})],1)])],1),e("div",{staticClass:"col-sm-4 text-center"},[e("p-form-row",{attrs:{id:"date-end",name:"date-end",label:t.$t("date end"),"is-horizontal":!1}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("p-date-picker",{attrs:{id:"date",name:"date",label:"date"},model:{value:t.date.end,callback:function(e){t.$set(t.date,"end",e)},expression:"date.end"}})],1)])],1)]),e("hr")]),e("div",{staticClass:"mt-10"},[e("span",{directives:[{name:"show",rawName:"v-show",value:t.checkedRow.length>0,expression:"checkedRow.length > 0"}],staticClass:"mr-15 animated fadeIn"})]),e("hr"),e("p-block-inner",{attrs:{"is-loading":t.isLoading}},[e("point-table",[e("tr",{attrs:{slot:"p-head"},slot:"p-head"},[e("th",[t._v("Number")]),e("th",[t._v("Date")]),e("th",[t._v("Customer")]),e("th",[t._v("Item")]),e("th",{staticClass:"text-right"},[t._v(" Quantity ")]),e("th",{staticClass:"text-right"},[t._v(" Price ")]),e("th",{staticClass:"text-right"},[t._v(" Amount ")]),e("th",{attrs:{width:"50px"}})]),t._l(t.salesOrders,(function(a,s){return t._l(a.items,(function(r,i){return e("tr",{key:"sales-order-"+s+"-i-"+i,attrs:{slot:"p-body"},slot:"p-body"},[null==t.item_id||t.item_id==r.item_id?[e("th",[e("router-link",{attrs:{to:{name:"sales.order.show",params:{id:a.id}}}},[t._v(" "+t._s(a.form.number)+" ")])],1),e("td",[t._v(t._s(t._f("dateFormat")(a.form.date,"DD MMMM YYYY HH:mm")))]),e("td",[a.customer?[t._v(" "+t._s(a.customer.name)+" ")]:t._e()],2),e("td",[t._v(t._s(r.item.name))]),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("numberFormat")(r.quantity))+" "+t._s(r.unit)+" ")]),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("numberFormat")(r.price-r.discount_value))+" ")]),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("numberFormat")(r.quantity*(r.price-r.discount_value)))+" ")]),e("td")]:t._e()],2)}))})),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("th"),e("td"),e("td"),e("td"),e("td",{staticClass:"text-right"}),e("td",{staticClass:"text-right"},[e("b",[t._v("TOTAL")])]),e("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("numberFormat")(t.total))+" ")]),e("td",{attrs:{width:"50px"}})])],2)],1),e("p-pagination",{attrs:{"current-page":t.currentPage,"last-page":t.lastPage},on:{updatePage:t.updatePage}})],1)],1),e("m-form-approval-status",{ref:"formApprovalStatus",on:{choosen:function(e){return t.chooseFormApprovalStatus(e)}}}),e("m-form-status",{ref:"formStatus",on:{choosen:function(e){return t.chooseFormStatus(e)}}}),e("m-item",{ref:"item",on:{choosen:t.chooseItem}})],1)},r=[],i=a("53ca"),o=a("5530"),n=(a("14d9"),a("a434"),a("d81d"),a("d3b7"),a("159b"),a("bea4")),d=a("5ae6"),l=a("208e"),c=a("b047"),u=a.n(c),h=a("feee"),m=a("2f62"),f={components:{SalesMenu:n["a"],Breadcrumb:d["a"],BreadcrumbSales:l["a"],PointTable:h["a"]},data:function(){return{isLoading:!0,currentPage:1*this.$route.query.page||1,lastPage:1,limit:1e3,item_id:null,item_label:null,isAdvanceFilter:!1,checkedRow:[],formStatus:{id:null,label:null,value:"notArchived"},formApprovalStatus:{id:null,label:null,value:null},total:0,date:{start:this.$route.query.date_from?this.$moment(this.$route.query.date_from).format("YYYY-MM-DD 00:00:00"):this.$moment().format("YYYY-MM-01 00:00:00"),end:this.$route.query.date_to?this.$moment(this.$route.query.date_to).format("YYYY-MM-DD 23:59:59"):this.$moment().format("YYYY-MM-DD 23:59:59")}}},computed:Object(o["a"])({},Object(m["c"])("salesOrder",["salesOrders","pagination"])),watch:{date:{handler:function(){this.$router.push({query:Object(o["a"])(Object(o["a"])({},this.$route.query),{},{date_from:this.date.start,date_to:this.date.end})}),this.getSalesOrder()},deep:!0}},created:function(){this.$router.push({query:Object(o["a"])(Object(o["a"])({},this.$route.query),{},{date_from:this.date.start,date_to:this.date.end})}),this.getSalesOrder()},updated:function(){this.lastPage=this.pagination.last_page},methods:Object(o["a"])(Object(o["a"])({},Object(m["b"])("salesOrder",["get"])),{},{chooseItem:function(t){this.item_id=t.id,this.item_label=t.label,this.getSalesOrder()},toggleCheckRow:function(t){this.isRowChecked(t)?this.checkedRow.splice(this.checkedRow.map((function(t){return t.id})).indexOf(t),1):this.checkedRow.push({id:t})},toggleCheckRows:function(){var t=this;this.isRowsChecked(this.salesOrders,this.checkedRow)?this.salesOrders.forEach((function(e){t.checkedRow.splice(t.checkedRow.map((function(t){return t.id})).indexOf(e.id),1)})):this.salesOrders.forEach((function(e){if(!t.isRowChecked(e.id)){var a=e.id;t.checkedRow.push({id:a})}}))},isRowChecked:function(t){return this.checkedRow.some((function(e){return e.id==t}))},isRowsChecked:function(t,e){if(0==e.length)return!1;for(var a=function(a){var s=e.some((function(e){return e.id==t[a].id}));if(!s)return{v:!1}},s=0;s<t.length;s++){var r=a(s);if("object"===Object(i["a"])(r))return r.v}return!0},bulkApprove:function(){var t=this;this.bulkApprove({salesOrders:this.checkedRow}).then((function(e){t.checkedRow=[],t.getSalesOrder()}))},chooseFormStatus:function(t){this.formStatus.label=t.label,this.formStatus.value=t.value,this.getSalesOrder()},chooseFormApprovalStatus:function(t){this.formApprovalStatus.label=t.label,this.formApprovalStatus.value=t.value,this.getSalesOrder()},filterSearch:u()((function(t){this.$router.push({query:Object(o["a"])(Object(o["a"])({},this.$route.query),{},{search:t})}),this.currentPage=1,this.getSalesOrder()}),300),getSalesOrder:function(){var t=this;this.isLoading=!0,this.get({params:{join:"form,customer,items,item",fields:"sales_order.*",sort_by:"-form.number",group_by:"form.id",filter_form:"active;approvalApproved",filter_date_min:{"form.date":this.serverDateTime(this.date.start,"start")},filter_date_max:{"form.date":this.serverDateTime(this.date.end,"end")},limit:this.limit,includes:"form;customer;items.item;items.allocation",page:this.currentPage}}).then((function(e){t.total=0,t.salesOrders.forEach((function(e){e.items.forEach((function(e){null!=t.item_id&&t.item_id!=e.item_id||(t.total+=parseFloat(e.quantity*(e.price-e.discount_value)))}))}))})).catch((function(e){t.$notification.error(e.message)})).finally((function(){t.isLoading=!1}))},updatePage:function(t){this.currentPage=t,this.getSalesOrder()}})},p=f,_=a("2877"),b=Object(_["a"])(p,s,r,!1,null,"7f6a60d1",null);e["default"]=b.exports}}]);
//# sourceMappingURL=chunk-51b742fe.f374734d.js.map
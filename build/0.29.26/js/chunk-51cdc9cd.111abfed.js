(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51cdc9cd"],{"208e":function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/sales"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("sales")))+" ")])},o=[],c=s("2877"),i={},n=Object(c["a"])(i,a,o,!1,null,null,null);e["a"]=n.exports},bb6e:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[e("breadcrumb",[e("breadcrumb-sales"),e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/sales/payment-collection"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("payment collection")))+" ")]),e("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t._f("uppercase")(t.$t("approval"))))])],1),e("div",{staticClass:"row"},[e("p-block",[e("div",{staticClass:"input-group block"},[t.$permission.has("create sales payment collection")?e("router-link",{staticClass:"input-group-prepend",attrs:{to:"/sales/payment-collection/create"}},[e("span",{staticClass:"input-group-text"},[e("i",{staticClass:"fa fa-plus"})])]):t._e(),e("p-form-input",{ref:"searchText",staticClass:"btn-block",attrs:{id:"search-text",name:"search-text",placeholder:"Search",value:t.searchText},on:{input:t.filterSearch}})],1),e("div",{staticClass:"input-group block"},[e("button",{staticClass:"btn btn-primary mr-3",on:{click:t.sendRequest}},[t._v(" Sent "+t._s(t.checkedRow.length)+" "+t._s("Request".concat(t.checkedRow.length>1?"s":""))+" "),e("i",{staticClass:"fa fa-paper-plane"})])]),e("hr"),e("p-block-inner",{attrs:{"is-loading":t.isLoading}},[e("point-table",[e("tr",{attrs:{slot:"p-head"},slot:"p-head"},[e("th",{attrs:{width:"50px"}},[e("p-form-check-box",{staticClass:"text-center",attrs:{id:"subscibe",name:"subscibe","is-form":!1,checked:t.isRowsChecked(t.salesPaymentCollections,t.checkedRow)},nativeOn:{click:function(e){return t.toggleCheckRows()}}})],1),e("th",{staticClass:"text-center"},[t._v(" Date Form ")]),e("th",{staticClass:"text-center"},[t._v(" Form Number ")]),e("th",{staticClass:"text-center"},[t._v(" Customer ")]),e("th",{staticClass:"text-center"},[t._v(" Notes ")]),e("th",{staticClass:"text-center"},[t._v(" Value ")]),e("th",{staticClass:"text-center"},[t._v(" Approval Status ")]),e("th",{staticClass:"text-center"},[t._v(" Last Request ")])]),t._l(t.salesPaymentCollections,(function(s,a){return[e("tr",{key:a,attrs:{slot:"p-body"},slot:"p-body"},[e("td",[e("p-form-check-box",{staticClass:"text-center",attrs:{id:"subscibe","is-form":!1,name:"subscibe",checked:t.isRowChecked(s.id)},nativeOn:{click:function(e){return t.toggleCheckRow(s.id)}}})],1),e("td",{staticClass:"text-center"},[t._v(" "+t._s(t._f("dateFormat")(s.date,"DD MMMM YYYY"))+" ")]),e("th",{staticClass:"text-center"},[e("router-link",{attrs:{to:{name:"sales.payment-collection.show",params:{id:s.id}}}},[t._v(" "+t._s(s.number)+" ")])],1),e("td",{staticClass:"text-center"},[t._v(" "+t._s(s.customer)+" ")]),e("td",{staticClass:"text-center"},[t._v(" "+t._s(s.notes)+" ")]),e("td",{staticClass:"text-center"},[t._v(" "+t._s(t._f("numberFormat")(s.amount))+" ")]),e("td",{staticClass:"text-center"},[0==s.approval_status?e("div",{staticClass:"badge badge-primary"},[t._v(" "+t._s(t._f("uppercase")(t.$t("pending")))+" ")]):t._e(),-1==s.approval_status?e("div",{staticClass:"badge badge-danger"},[t._v(" "+t._s(t._f("uppercase")(t.$t("rejected")))+" ")]):t._e(),1==s.approval_status?e("div",{staticClass:"badge badge-success"},[t._v(" "+t._s(t._f("uppercase")(t.$t("approved")))+" ")]):t._e()]),e("td",{staticClass:"text-center"},[s.last_request_date?e("span",[t._v(" "+t._s(t._f("dateFormat")(s.last_request_date,"DD MMMM YYYY HH:mm"))+" ")]):t._e()])])]}))],2)],1),e("p-pagination",{attrs:{"current-page":t.currentPage,"last-page":t.lastPage},on:{updatePage:t.updatePage}})],1)],1),e("m-form-approval-status",{ref:"formApprovalStatus",on:{choosen:function(e){return t.chooseFormApprovalStatus(e)}}}),e("m-form-status",{ref:"formStatus",on:{choosen:function(e){return t.chooseFormStatus(e)}}})],1)},o=[],c=s("53ca"),i=s("5530"),n=(s("ac1f"),s("841c"),s("14d9"),s("a434"),s("d81d"),s("d3b7"),s("159b"),s("5ae6")),r=s("208e"),l=s("b047"),u=s.n(l),h=s("feee"),d=s("2f62"),p=s("7f45"),m=s.n(p),f={components:{Breadcrumb:n["a"],BreadcrumbSales:r["a"],PointTable:h["a"]},data:function(){return{isLoading:!0,searchText:this.$route.query.search,currentPage:1*this.$route.query.page||1,lastPage:1,limit:10,checkedRow:[],date:{start:this.$route.query.date_from?this.$moment(this.$route.query.date_from).format("YYYY-MM-DD 00:00:00"):this.$moment().format("YYYY-MM-01 00:00:00"),end:this.$route.query.date_to?this.$moment(this.$route.query.date_to).format("YYYY-MM-DD 23:59:59"):this.$moment().format("YYYY-MM-DD 23:59:59")}}},computed:Object(i["a"])({},Object(d["c"])("salesPaymentCollectionApproval",["salesPaymentCollections","pagination"])),watch:{date:{handler:function(){this.$router.push({query:Object(i["a"])(Object(i["a"])({},this.$route.query),{},{date_from:this.date.start,date_to:this.date.end})}),this.getSalesPaymentCollection()},deep:!0}},created:function(){this.$router.push({query:Object(i["a"])(Object(i["a"])({},this.$route.query),{},{date_from:this.date.start,date_to:this.date.end})}),this.getSalesPaymentCollection()},updated:function(){this.lastPage=this.pagination.last_page},methods:Object(i["a"])(Object(i["a"])(Object(i["a"])({},Object(d["b"])("salesPaymentCollection",["addHistories"])),Object(d["b"])("salesPaymentCollectionApproval",["get","send"])),{},{toggleCheckRow:function(t){this.isRowChecked(t)?this.checkedRow.splice(this.checkedRow.map((function(t){return t.id})).indexOf(t),1):this.checkedRow.push({id:t})},toggleCheckRows:function(){var t=this;this.isRowsChecked(this.salesPaymentCollections,this.checkedRow)?this.salesPaymentCollections.forEach((function(e){t.checkedRow.splice(t.checkedRow.map((function(t){return t.id})).indexOf(e.id),1)})):this.salesPaymentCollections.forEach((function(e){if(!t.isRowChecked(e.id)){var s=e.id;t.checkedRow.push({id:s})}}))},isRowChecked:function(t){return this.checkedRow.some((function(e){return e.id==t}))},isRowsChecked:function(t,e){if(0==e.length)return!1;for(var s=function(s){var a=e.some((function(e){return e.id==t[s].id}));if(!a)return{v:!1}},a=0;a<t.length;a++){var o=s(a);if("object"===Object(c["a"])(o))return o.v}return!0},bulkApprove:function(){var t=this;this.bulkApprove({salesPaymentCollections:this.checkedRow}).then((function(e){t.checkedRow=[],t.getSalesPaymentCollection()}))},chooseFormStatus:function(t){this.formStatus.label=t.label,this.formStatus.value=t.value,this.getSalesPaymentCollection()},chooseFormApprovalStatus:function(t){this.formApprovalStatus.label=t.label,this.formApprovalStatus.value=t.value,this.getSalesPaymentCollection()},filterSearch:u()((function(t){this.$router.push({query:Object(i["a"])(Object(i["a"])({},this.$route.query),{},{search:t})}),this.searchText=t,this.currentPage=1,this.getSalesPaymentCollection()}),300),getSalesPaymentCollection:function(){var t=this;this.isLoading=!0,this.get({params:{filter_like:this.searchText,limit:10,page:this.currentPage}}).catch((function(e){t.$notification.error(e.message)})).finally((function(){t.salesPaymentCollections.forEach((function(t){if(null!=t.last_request_date){var e=m.a.utc(t.last_request_date).toDate(),s=m()(e).local().format("YYYY-MM-DD HH:mm:ss");t.last_request_date=s}})),t.isLoading=!1}))},updatePage:function(t){this.currentPage=t,this.getSalesPaymentCollection()},sendRequest:function(){var t=this;this.checkedRow.length>0&&(this.isLoading=!0,this.send({ids:this.checkedRow}).then((function(e){t.$notification.success("sending email approval success"),t.checkedRow=[],t.addHistories({ids:e.input.ids,activity:"Request Approval"}).then((function(e){t.getSalesPaymentCollection()})).catch((function(e){t.$notification.error(e.message),t.form.errors.record(e.errors)}))})).catch((function(e){t.isLoading=!1,t.$notification.error(e.message)})))}})},b=f,_=s("2877"),v=Object(_["a"])(b,a,o,!1,null,"50057002",null);e["default"]=v.exports}}]);
//# sourceMappingURL=chunk-51cdc9cd.111abfed.js.map
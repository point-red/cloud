(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21d066"],{d015:function(e,t,r){"use strict";r.r(t);r("a4d3"),r("e01a"),r("b0c0");var o=function(){var e=this,t=e._self._c;return t("div",[t("p-loading-block",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}],attrs:{message:e.loadingMessage}}),t("breadcrumb",[t("breadcrumb-plugin"),t("breadcrumb-pin-point"),t("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/plugin/pin-point/sales-visitation-form"}},[e._v(" "+e._s(e._f("uppercase")(e.$t("sales visitation")))+" ")]),t("span",{staticClass:"breadcrumb-item active"},[e._v(e._s(e._f("uppercase")(e.$t("create"))))])],1),t("tab-menu"),t("form",{staticClass:"row",on:{submit:function(t){return t.preventDefault(),e.onSubmit.apply(null,arguments)}}},[t("p-block",{attrs:{"is-loading":e.isLoading,header:!1,title:e.$t("sales visitation"),column:"col-sm-12"}},[t("h5",[e._v(e._s(e._f("uppercase")(e.$t("sales visitation"))))]),t("hr"),t("p-form-row",{attrs:{label:e.$t("photo")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("p-camera",{attrs:{image:e.form.image},on:{onCaptured:function(t){return e.onCaptured(t)}}})],1)]),t("p-form-row",{attrs:{id:"customer",name:"customer",label:e.$t("customer*"),disabled:e.isSaving,errors:e.form.errors.get("customer")},on:{errors:function(t){return e.form.errors.set("customer",null)}},model:{value:e.form.customer,callback:function(t){e.$set(e.form,"customer",t)},expression:"form.customer"}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("span",{staticClass:"select-link",on:{click:function(t){return e.$refs.customer.open()}}},[e._v(e._s(e._f("uppercase")(e.form.customer_name||e.$t("select"))))])])]),t("p-form-row",{attrs:{label:"customer group*"}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("span",{staticClass:"select-link",on:{click:function(t){return e.$refs.group.open()}}},[e._v(e._s(e._f("uppercase")(e.form.group_name||e.$t("select"))))])])]),t("p-form-row",{attrs:{id:"gmap",name:"gmap",label:"Google Map - "+e.$t("address"),placeholder:""+e.$t("address")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("gmap-autocomplete",{staticClass:"form-control",attrs:{value:e.description,disabled:!0},on:{place_changed:e.setPlace,keypress:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault()}}}),t("gmap-map",{ref:"map",staticStyle:{width:"100%",height:"200px"},attrs:{id:"map",center:e.center,zoom:15,options:{disableDefaultUI:!0,styles:[{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"labels.text",stylers:[{visibility:"off"}]}]}}},e._l(e.markers,(function(r,o){return t("gmap-marker",{key:o,attrs:{position:e.center=r.position,clickable:!0,draggable:!0},on:{click:function(t){e.center=r.position}}})})),1)],1)]),t("p-form-row",{attrs:{id:"address",name:"address",label:e.$t("address")+"*",placeholder:e.$t("address"),disabled:e.isSaving,errors:e.form.errors.get("address")},on:{errors:function(t){return e.form.errors.set("address",null)}},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}}),t("p-form-row",{attrs:{id:"district",name:"district",placeholder:e.$t("district"),disabled:e.isSaving,errors:e.form.errors.get("district")},on:{errors:function(t){return e.form.errors.set("district",null)}},model:{value:e.form.district,callback:function(t){e.$set(e.form,"district",t)},expression:"form.district"}}),t("p-form-row",{attrs:{id:"sub_district",name:"sub_district",placeholder:e.$t("sub district"),disabled:e.isSaving,errors:e.form.errors.get("sub_district")},on:{errors:function(t){return e.form.errors.set("sub_district",null)}},model:{value:e.form.sub_district,callback:function(t){e.$set(e.form,"sub_district",t)},expression:"form.sub_district"}}),t("p-form-row",{attrs:{id:"phone",name:"phone",label:e.$t("phone")+"*",disabled:e.isSaving,errors:e.form.errors.get("phone")},on:{errors:function(t){return e.form.errors.set("phone",null)}},model:{value:e.form.phone,callback:function(t){e.$set(e.form,"phone",t)},expression:"form.phone"}}),t("p-form-row",{attrs:{id:"similar-product",name:"similar_product",label:e._f("titlecase")(e.$t("similar product")+"*")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("span",{staticClass:"select-link",on:{click:function(t){return e.$refs.similarProduct.open(e.form.similar_products)}}},[0==e.form.similar_products.length?[e._v(e._s(e._f("uppercase")(e.$t("select"))))]:e._e(),e._l(e.form.similar_products,(function(t,r){return[e._v(" "+e._s(e._f("uppercase")(t.name))),r+1!=e.form.similar_products.length?[e._v(",")]:e._e()]}))],2)])]),t("p-form-row",{attrs:{id:"interest",name:"interest",label:e._f("titlecase")(e.$t("interest reason")+"*")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("span",{staticClass:"select-link",on:{click:function(t){return e.$refs.interestReason.open(e.form.interest_reasons)}}},[0==e.form.interest_reasons.length?[e._v(e._s(e._f("uppercase")(e.$t("select"))))]:e._e(),e._l(e.form.interest_reasons,(function(t,r){return[e._v(" "+e._s(e._f("uppercase")(t.name))),r+1!=e.form.interest_reasons.length?[e._v(",")]:e._e()]}))],2)])]),t("p-form-row",{attrs:{id:"no-interest",name:"no_interest",label:e.$t("no interest reason")+"*"}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("span",{staticClass:"select-link",on:{click:function(t){return e.$refs.noInterestReason.open(e.form.no_interest_reasons)}}},[0==e.form.no_interest_reasons.length?[e._v(e._s(e._f("uppercase")(e.$t("select"))))]:e._e(),e._l(e.form.no_interest_reasons,(function(t,r){return[e._v(" "+e._s(e._f("uppercase")(t.name))),r+1!=e.form.no_interest_reasons.length?[e._v(",")]:e._e()]}))],2)])]),t("p-form-row",{attrs:{id:"notes",name:"notes",label:"notes",disabled:e.isSaving,errors:e.form.errors.get("notes")},on:{errors:function(t){return e.form.errors.set("notes",null)}},model:{value:e.form.notes,callback:function(t){e.$set(e.form,"notes",t)},expression:"form.notes"}}),t("p-separator"),t("h5",[e._v(e._s(e._f("uppercase")(e.$t("form sales"))))]),t("hr"),t("p-form-row",{attrs:{label:e.$t("date")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("p-date-picker",{attrs:{id:"date",name:"date",label:"date",type:"datetime",format:"YYYY-MM-DD HH:mm:ss",errors:e.form.errors.get("date")},on:{errors:function(t){return e.form.errors.set("date",null)}},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1)]),t("hr"),t("p-form-row",{attrs:{label:e._f("titlecase")(e.$t("payment method"))}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("label",{staticClass:"css-control css-control-primary css-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.payment_method,expression:"form.payment_method"}],staticClass:"css-control-input",attrs:{type:"radio",name:"radio-group2"},domProps:{value:"cash",checked:e._q(e.form.payment_method,"cash")},on:{change:function(t){return e.$set(e.form,"payment_method","cash")}}}),t("span",{staticClass:"css-control-indicator"}),e._v(" Tunai ")]),t("label",{staticClass:"css-control css-control-primary css-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.payment_method,expression:"form.payment_method"}],staticClass:"css-control-input",attrs:{type:"radio",name:"radio-group2"},domProps:{value:"credit",checked:e._q(e.form.payment_method,"credit")},on:{change:function(t){return e.$set(e.form,"payment_method","credit")}}}),t("span",{staticClass:"css-control-indicator"}),e._v(" Tempo ")]),t("label",{staticClass:"css-control css-control-primary css-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.payment_method,expression:"form.payment_method"}],staticClass:"css-control-input",attrs:{type:"radio",name:"radio-group2"},domProps:{value:"taking-order",checked:e._q(e.form.payment_method,"taking-order")},on:{change:function(t){return e.$set(e.form,"payment_method","taking-order")}}}),t("span",{staticClass:"css-control-indicator"}),e._v(" Taking Order ")]),t("label",{staticClass:"css-control css-control-primary css-radio"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.payment_method,expression:"form.payment_method"}],staticClass:"css-control-input",attrs:{type:"radio",name:"radio-group2"},domProps:{value:"sell-out",checked:e._q(e.form.payment_method,"sell-out")},on:{change:function(t){return e.$set(e.form,"payment_method","sell-out")}}}),t("span",{staticClass:"css-control-indicator"}),e._v(" Sell Out ")])])]),t("p-form-row",{directives:[{name:"show",rawName:"v-show",value:"credit"===e.form.payment_method,expression:"form.payment_method === 'credit'"}],attrs:{id:"date",name:"date",label:e.$t("due date")}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("p-date-picker",{attrs:{id:"date",name:"date",label:"date",errors:e.form.errors.get("date")},on:{errors:function(t){return e.form.errors.set("date",null)}},model:{value:e.form.due_date,callback:function(t){e.$set(e.form,"due_date",t)},expression:"form.due_date"}})],1)]),t("p-form-row",{directives:[{name:"show",rawName:"v-show",value:"credit"===e.form.payment_method,expression:"form.payment_method === 'credit'"}],attrs:{label:e._f("titlecase")(e.$t("payment received"))}},[t("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[t("p-form-number",{attrs:{id:"payment-received",name:"payment_received",disabled:e.isSaving,errors:e.form.errors.get("payment_received"),"is-text-right":!1},on:{errors:function(t){return e.form.errors.set("payment_received",null)}},model:{value:e.form.payment_received,callback:function(t){e.$set(e.form,"payment_received",t)},expression:"form.payment_received"}})],1)]),t("p-table",[t("tr",{attrs:{slot:"p-head"},slot:"p-head"},[t("th",[e._v("Item")]),t("th",[e._v("Jumlah")]),t("th",[e._v("Harga Satuan")]),t("th",[e._v("Total")])]),e._l(e.form.items,(function(r,o){return t("tr",{key:"row-"+o,attrs:{slot:"p-body"},slot:"p-body"},[t("td",[t("span",{staticClass:"select-link",on:{click:function(t){return e.$refs.item.open(o)}}},[e._v(" "+e._s(e._f("uppercase")(r.item_label||e.$t("select")))+" ")])]),t("td",[t("p-quantity",{attrs:{id:"quantity"+o,name:"quantity"+o,"item-id":r.item_id,units:r.units,unit:{name:r.unit,label:r.unit,converter:r.converter},max:1*r.quantity_pending,readonly:e.onClickUnit(r)},on:{choosen:function(t){return e.chooseUnit(t,r)}},nativeOn:{click:function(t){return e.onClickQuantity(r,o)},keyup:function(t){return e.calculate.apply(null,arguments)}},model:{value:r.quantity,callback:function(t){e.$set(r,"quantity",t)},expression:"row.quantity"}})],1),t("td",[t("p-form-number",{attrs:{id:"price"+o,name:"price"+o,disabled:null==r.item_id},nativeOn:{keyup:function(t){return e.calculate.apply(null,arguments)}},model:{value:r.price,callback:function(t){e.$set(r,"price",t)},expression:"row.price"}})],1),t("td",[t("p-form-number",{attrs:{id:"total"+o,name:"total"+o,disabled:!0},model:{value:r.total,callback:function(t){e.$set(r,"total",t)},expression:"row.total"}})],1)])})),t("tr",{attrs:{slot:"p-body"},slot:"p-body"},[t("td"),t("td"),t("td",[e._v("Total")]),t("td",[t("p-form-number",{attrs:{readonly:!0,"is-text-right":!0},model:{value:e.form.total_price,callback:function(t){e.$set(e.form,"total_price",t)},expression:"form.total_price"}})],1)])],2),t("hr"),t("div",{staticClass:"form-group row"},[t("div",{staticClass:"col-md-12"},[t("button",{staticClass:"btn btn-sm btn-primary",attrs:{disabled:e.isSaving,type:"submit"}},[t("i",{directives:[{name:"show",rawName:"v-show",value:e.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),e._v(" "+e._s(e._f("uppercase")(e.$t("save")))+" ")])])])],1)],1),t("m-inventory-out",{ref:"inventory",attrs:{id:"inventory","disable-unit-selection":!0},on:{updated:function(t){return e.updateDna(t)}}}),t("m-warehouse",{ref:"warehouse",attrs:{id:"warehouse_id"},on:{choosen:function(t){return e.chooseWarehouse(t)}}}),t("m-customer",{ref:"customer",on:{choosen:e.chooseCustomer}}),t("m-customer-group",{ref:"group",on:{choosen:e.chooseGroup}}),t("m-item",{ref:"item",on:{choosen:function(t){return e.chooseItem(t)}}}),t("m-m-interest-reason",{ref:"interestReason",on:{choosen:function(t){return e.chooseInterestReason(t)}}}),t("m-m-no-interest-reason",{ref:"noInterestReason",on:{choosen:function(t){return e.chooseNoInterestReason(t)}}}),t("m-m-similar-product",{ref:"similarProduct",on:{choosen:function(t){return e.chooseSimilarProduct(t)}}})],1)},s=[],n=r("c7eb"),i=r("1da1"),a=r("5530"),l=(r("d81d"),r("14d9"),r("d3b7"),r("159b"),r("4de4"),r("2ef0")),c=r("fabd"),m=r("5ae6"),u=r("bc27"),d=r("8e1a"),p=r("b7ae"),f=r("3c87"),h=r("a357"),_=r("6feb"),b=r("2f62"),g={components:{TabMenu:c["a"],Breadcrumb:m["a"],BreadcrumbPlugin:u["a"],BreadcrumbPinPoint:d["a"],MMInterestReason:f["a"],MMNoInterestReason:h["a"],MMSimilarProduct:_["a"]},data:function(){return{gmapApiKey:"",isLoading:!1,loadingMessage:"Loading...",isSaving:!1,warehouseId:null,warehouseName:null,form:new p["a"]({date:this.serverDateTime(),image:null,customer_id:null,branch_id:null,warehouse_id:null,customer_name:this.$route.query.name||"",address:this.$route.query.address||"",district:this.$route.query.district||"",sub_district:this.$route.query.sub_district||"",latitude:this.$route.query.latitude||"",longitude:this.$route.query.longitude||"",group_id:null,group_name:null,phone:"",notes:"",interest_reasons:[],no_interest_reasons:[],similar_products:[],items:[],total_price:0,payment_method:"cash",due_date:null,received_payment:0}),center:{lat:23.8103,lng:90.4125},markers:[{position:{lat:10,lng:10}}],addressComponent:{},description:"",place:null}},computed:Object(a["a"])({},Object(b["c"])("auth",["authUser"])),mounted:function(){var e=this;return Object(i["a"])(Object(n["a"])().mark((function t(){return Object(n["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isLoading=!1,e.loadingMessage="Searching current location",t.next=4,e.getLocation();case 4:case"end":return t.stop()}}),t)})))()},created:function(){this.addItemRow(),this.form.branch_id=this.authUser.branch.id,this.form.warehouse_id=this.authUser.warehouse.id,this.warehouseId=this.authUser.warehouse.id,this.warehouseName=this.authUser.warehouse.name},methods:Object(a["a"])(Object(a["a"])({},Object(b["b"])("pluginPinPointSalesVisitationForm",["create"])),{},{chooseWarehouse:function(e){this.warehouseId=e.id,this.warehouseName=e.name,this.form.warehouse_id=e.id},onClickQuantity:function(e,t){"sell-out"!=this.form.payment_method&&"taking-order"!=this.form.payment_method&&(1!=e.require_expiry_date&&1!=e.require_production_number||(e.warehouse_id=this.warehouseId,e.index=t,this.$refs.inventory.open(e,e.quantity)))},onClickUnit:function(e){return"sell-out"!=this.form.payment_method&&"taking-order"!=this.form.payment_method&&(null==e.item_id||1===e.require_expiry_date||1===e.require_production_number)},chooseUnit:function(e,t){t.unit=e.label,t.converter=e.converter},updateDna:function(e){console.log(e),this.form.items[e.index].dna=e.dna,this.form.items[e.index].quantity=e.quantity,this.form.items[e.index].unit=e.unit,this.form.items[e.index].converter=e.converter},onCaptured:function(e){this.form.image=e},getLocation:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(e){var t=this,r={lat:e.coords.latitude,lng:e.coords.longitude};this.center.lat=r.lat,this.center.lng=r.lng,this.form.latitude=r.lat,this.form.longitude=r.lng,this.markers[0].position.lat=r.lat,this.markers[0].position.lng=r.lng,this.$refs.map.$mapPromise.then((function(){t.isLoading=!1,t.geocodeLatLng(new google.maps.Geocoder,r,google.maps.InfoWindow)})).catch((function(e){t.isLoading=!1}))}.bind(this)):this.loadingMessage="Geolocation not available, please update your browser or using another browser"},addMoreSimilarProduct:function(){this.form.similar_products.push({id:null,name:null})},chooseCustomer:function(e){e.groups.length>=1&&(this.form.group_id=e.groups[0].id,this.form.group_name=e.groups[0].name),this.form.customer_id=e.id,this.form.customer_name=e.name},chooseGroup:function(e){this.form.group_id=e.id,this.form.group_name=e.name},setDescription:function(e){this.description=e},setPlace:function(e){var t=this;this.center.lat=e.geometry.location.lat(),this.center.lng=e.geometry.location.lng(),this.markers[0].position.lat=e.geometry.location.lat(),this.markers[0].position.lng=e.geometry.location.lng(),this.addressComponent=e,this.setDescription(this.addressComponent.formatted_address),this.form.address=this.addressComponent.formatted_address,this.form.district="",this.form.sub_district="",this.addressComponent.address_components.forEach((function(e){e.types&&e.types.forEach((function(r){"administrative_area_level_3"==r?t.form.district=e.long_name:"administrative_area_level_4"==r&&(t.form.sub_district=e.long_name)}))}))},geocodeLatLng:function(e,t,r){var o=this;e.geocode({location:this.center},(function(e,t){"OK"==t&&(o.addressComponent=e[0],o.setDescription(o.addressComponent.formatted_address),o.form.address=o.addressComponent.formatted_address,o.addressComponent.address_components.forEach((function(e){e.types&&e.types.forEach((function(t){"administrative_area_level_3"==t?o.form.district=e.long_name:"administrative_area_level_4"==t&&(o.form.sub_district=e.long_name)}))})))}))},addItemRow:function(){this.form.items.push({item_id:null,item_name:null,item_label:null,chart_of_account_id:null,chart_of_account_name:null,require_expiry_date:null,require_production_number:null,unit:null,converter:null,quantity:null,allocation_id:null,allocation_name:null,notes:null,more:!1,units:[{label:"",name:"",converter:null}]})},chooseItem:function(e){if(null!=e.id){var t=this.form.items[e.index];t.item=e,t.item_id=e.id,t.item_name=e.name,t.item_label=e.label,t.require_production_number=e.require_production_number,t.require_expiry_date=e.require_expiry_date,t.units=e.units,t.units.forEach((function(r,o){r.id==e.unit_default_sales&&(t.unit=r.label,t.converter=r.converter)}));var r=!0;this.form.items.forEach((function(e){null==e.item_id&&(r=!1)})),r&&this.addItemRow(),this.calculate()}else this.clearItem(e.index)},clearItem:function(e){e.item_id=null,e.item_name=null,e.item_label=null,e.unit=null,e.converter=null,e.quantity=null,e.price=null,e.allocation_id=null,e.notes=null,e.more=!1,e.units=[],this.form.items.length>1&&(this.form.items=this.form.items.filter((function(e){return null!==e.item_id})),this.addItemRow())},chooseInterestReason:function(e){this.form.interest_reasons=e},chooseNoInterestReason:function(e){this.form.no_interest_reasons=e},chooseSimilarProduct:function(e){this.form.similar_products=e},calculate:Object(l["debounce"])((function(e){var t=this;this.form.total_price=0,this.form.items.forEach((function(e){e.price>0&&e.quantity>0&&(e.total=e.quantity*e.price,t.form.total_price+=parseFloat(e.total))}))}),100),onSubmit:function(){var e=this;this.isSaving=!0,this.create(this.form).then((function(t){e.isSaving=!1,e.$notification.success("Create success"),e.$store.dispatch("accountRewardPoint/get"),e.$router.push("/plugin/pin-point/sales-visitation-form")})).catch((function(t){e.isSaving=!1,e.$notification.error(t.message),t.errors&&e.form.errors.record(t.errors)}))}})},v=g,y=r("2877"),w=Object(y["a"])(v,o,s,!1,null,null,null);t["default"]=w.exports}}]);
//# sourceMappingURL=chunk-2d21d066.00f5e26c.js.map
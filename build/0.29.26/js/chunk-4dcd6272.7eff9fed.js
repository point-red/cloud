(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4dcd6272"],{"0e0d":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/pos"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("pos")))+" ")])},r=[],o=i("2877"),n={},a=Object(o["a"])(n,s,r,!1,null,null,null);e["a"]=a.exports},"4ced":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",[e("form",{staticClass:"row"},[e("p-modal",{ref:"serviceModal",attrs:{id:t.id,"is-loading":t.isLoading,title:t._f("uppercase")(t.title)}},[e("template",{slot:"content"},[e("p-form-row",{attrs:{id:"service-name",name:"service-name",label:"name",disabled:!0},model:{value:t.service_name,callback:function(e){t.service_name=e},expression:"service_name"}}),e("p-form-row",{attrs:{id:"price",name:"price",label:t.$t("price")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-form-number",{attrs:{disabled:!0,"is-text-right":!1},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1)]),e("p-form-row",{attrs:{id:"quantity",name:"quantity",label:t.$t("quantity")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-quantity",{attrs:{readonly:t.isSaving,"is-text-right":!1,unsigned:!0,"show-add-reduce-buttons":!0},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}})],1)]),e("p-form-row",{attrs:{id:"discount-percent",name:"discount-percent",label:t.$t("discount")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-quantity",{attrs:{readonly:t.isSaving,"is-text-right":!1,unsigned:!0,unit:"%"},model:{value:t.discount_percent,callback:function(e){t.discount_percent=e},expression:"discount_percent"}})],1)]),e("p-form-row",{attrs:{id:"notes",name:"notes",label:t.$t("notes")}},[e("div",{staticClass:"col-lg-12 mt-5",attrs:{slot:"body"},slot:"body"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notes,expression:"notes"}],staticClass:"form-control",attrs:{rows:"5",placeholder:"Notes",readonly:t.isSaving},domProps:{value:t.notes},on:{input:function(e){e.target.composing||(t.notes=e.target.value)}}})])])],1),e("template",{slot:"footer"},[e("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{disabled:t.isSaving,type:"button"},on:{click:t.close}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("close")))+" ")])])],2)],1)])},r=[],o={props:{id:{type:String,required:!0}},data:function(){return{isLoading:!1,title:"Service",isSaving:!1,index:null,service_name:null,quantity:null,price:null,discount_percent:null,notes:null}},methods:{show:function(t,e){this.index=t,this.service_name=e.service_name,this.quantity=e.quantity,this.price=e.price,this.discount_percent=e.discount_percent,this.notes=e.notes,this.$refs.serviceModal.show()},close:function(){this.discount_percent>100?this.discount_percent=100:this.discount_percent<0&&(this.discount_percent=0),this.$emit("updateService",{service:{index:this.index,quantity:parseFloat(this.quantity),discount_percent:parseFloat(this.discount_percent),notes:this.notes}}),this.index=null,this.service_name=null,this.quantity=null,this.price=null,this.discount_percent=null,this.notes=null,this.$refs.serviceModal.close()}}},n=o,a=i("2877"),c=Object(a["a"])(n,s,r,!1,null,null,null);e["a"]=c.exports},"54b6":function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",[e("form",{staticClass:"row"},[e("p-modal",{ref:"discountModal",attrs:{id:t.id,"is-loading":t.isLoading,title:t._f("uppercase")(t.title)}},[e("template",{slot:"content"},[e("p-form-row",{attrs:{id:"discount",name:"discount",label:t.$t("discount")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-form-number",{attrs:{"is-text-right":!1},model:{value:t.discount_percent,callback:function(e){t.discount_percent=e},expression:"discount_percent"}})],1)])],1),e("template",{slot:"footer"},[e("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{disabled:t.isSaving,type:"button"},on:{click:t.close}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("close")))+" ")])])],2)],1)])},r=[],o={props:{id:{type:String,required:!0}},data:function(){return{isLoading:!1,title:"Discount",isSaving:!1,discount_percent:0}},methods:{show:function(t){this.discount_percent=t,this.$refs.discountModal.show()},close:function(){this.discount_percent>100?this.discount_percent=100:this.discount_percent<0&&(this.discount_percent=0),this.$emit("updateDiscount",{discount_percent:this.discount_percent}),this.discount_percent=0,this.$refs.discountModal.close()}}},n=o,a=i("2877"),c=Object(a["a"])(n,s,r,!1,null,null,null);e["a"]=c.exports},9887:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",[e("form",{staticClass:"row"},[e("p-modal",{ref:"itemModal",attrs:{id:t.id,"is-loading":t.isLoading,title:t._f("uppercase")(t.title)}},[e("template",{slot:"content"},[e("p-form-row",{attrs:{id:"item-name",name:"item-name",label:"name",disabled:!0},model:{value:t.item_name,callback:function(e){t.item_name=e},expression:"item_name"}}),e("p-form-row",{attrs:{id:"price",name:"price",label:t.$t("price")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-form-number",{attrs:{disabled:!0,"is-text-right":!1},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1)]),e("p-form-row",{attrs:{id:"quantity",name:"quantity",label:t.$t("quantity")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-quantity",{attrs:{readonly:t.isSaving,"is-text-right":!1,unsigned:!0,unit:t.unit.label,"show-add-reduce-buttons":!0},model:{value:t.quantity,callback:function(e){t.quantity=e},expression:"quantity"}})],1)]),e("p-form-row",{attrs:{id:"discount-percent",name:"discount-percent",label:t.$t("discount")}},[e("div",{staticClass:"col-lg-9",attrs:{slot:"body"},slot:"body"},[e("p-quantity",{attrs:{readonly:t.isSaving,"is-text-right":!1,unsigned:!0,unit:"%"},model:{value:t.discount_percent,callback:function(e){t.discount_percent=e},expression:"discount_percent"}})],1)]),e("p-form-row",{attrs:{id:"notes",name:"notes",label:t.$t("notes")}},[e("div",{staticClass:"col-lg-12 mt-5",attrs:{slot:"body"},slot:"body"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.notes,expression:"notes"}],staticClass:"form-control",attrs:{rows:"5",placeholder:"Notes",readonly:t.isSaving},domProps:{value:t.notes},on:{input:function(e){e.target.composing||(t.notes=e.target.value)}}})])])],1),e("template",{slot:"footer"},[e("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{disabled:t.isSaving,type:"button"},on:{click:t.close}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("close")))+" ")])])],2)],1)])},r=[],o={props:{id:{type:String,required:!0}},data:function(){return{isLoading:!1,title:"Item",isSaving:!1,index:null,item_name:null,unit:"",quantity:null,price:null,discount_percent:null,notes:null,production_number:null,expiry_date:this.$moment().format("YYYY-MM-DD")}},methods:{show:function(t,e){this.index=t,this.item_name=e.item_name,this.unit=e.item_unit,this.quantity=e.quantity,this.price=e.price,this.discount_percent=e.discount_percent,this.notes=e.notes,this.production_number=e.production_number,this.expiry_date=this.$options.filters.dateFormat(e.expiry_date,"DD MMMM YYYY"),this.$refs.itemModal.show()},close:function(){this.discount_percent>100?this.discount_percent=100:this.discount_percent<0&&(this.discount_percent=0),this.$emit("updateItem",{item:{index:this.index,quantity:parseFloat(this.quantity),discount_percent:parseFloat(this.discount_percent),notes:this.notes}}),this.index=null,this.item_name=null,this.unit="",this.quantity=null,this.price=null,this.discount_percent=null,this.notes=null,this.production_number=null,this.expiry_date=null,this.$refs.itemModal.close()}}},n=o,a=i("2877"),c=Object(a["a"])(n,s,r,!1,null,null,null);e["a"]=c.exports},e28f:function(t,e,i){"use strict";i.r(e);i("b0c0"),i("caad"),i("2532");var s=function(){var t=this,e=t._self._c;return e("div",[e("breadcrumb",[e("breadcrumb-pos"),e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/pos/open-bill"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("open bill")))+" ")]),e("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t._f("uppercase")(t.$t("create"))))])],1),e("form",{staticClass:"row"},[e("p-block",{attrs:{header:!0,title:t.$t("bill"),"is-fullscreen":!0,"show-fullscreen-button":!1,"show-hidden-button":!1,column:"col-sm-12"},scopedSlots:t._u([{key:"header",fn:function(){return[t.$permission.has("create pos")?e("router-link",{attrs:{to:"/pos/open-bill/create",exact:""}},[e("button",{staticClass:"btn-block-option",attrs:{type:"button"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("add")))+" ")])]):t._e(),t._v("| "),t.$permission.has("read pos")?e("router-link",{attrs:{to:"/pos/open-bill",exact:""}},[e("button",{staticClass:"btn-block-option",attrs:{type:"button"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("list")))+" ")])]):t._e(),t._v("| ")]},proxy:!0}])},[e("p-block-inner",{attrs:{"is-loading":t.isGroupLoading}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-8"},[e("ul",{staticClass:"nav nav-tabs nav-tabs-alt mb-15",attrs:{"data-toggle":"tabs",role:"tablist"}},[t._l(t.itemGroups,(function(i,s){return e("li",{key:"item-group-"+s,staticClass:"nav-item"},[t.currentGroup&&"item"===t.currentGroupType&&i.id===t.currentGroup.id?e("a",{staticClass:"nav-link active"},[t._v(t._s(i.name))]):e("a",{staticClass:"nav-link",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.selectGroup(i,"item")}}},[t._v(t._s(i.name))])])})),t._l(t.serviceGroups,(function(i,s){return e("li",{key:"service-group-"+s,staticClass:"nav-item"},[t.currentGroup&&"service"===t.currentGroupType&&i.id===t.currentGroup.id?e("a",{staticClass:"nav-link active"},[t._v(t._s(i.name))]):e("a",{staticClass:"nav-link",staticStyle:{cursor:"pointer"},on:{click:function(e){return t.selectGroup(i,"service")}}},[t._v(t._s(i.name))])])}))],2),e("p-form-input",{attrs:{id:"search-text",name:"search-text",placeholder:"Search",disabled:t.isSaving||t.isLoading||t.isGroupLoading},on:{input:t.filterSearch},model:{value:t.searchText,callback:function(e){t.searchText=e},expression:"searchText"}}),e("p-block-inner",{attrs:{"is-loading":t.isLoading}},[e("div",{staticClass:"row gutters-tiny"},[t._l(t.itemList,(function(i,s){return["item"===t.currentGroupType?[t.groupItemList.includes(i.item_id)?e("p-box-item",{key:"item-"+s,attrs:{id:"item-"+s,item:i,"item-name":i.item_name,"item-price":i.price,"item-unit":i.item_unit,clicked:t.chooseItem}}):t._e()]:t._e()]})),t._l(t.serviceList,(function(i,s){return["service"===t.currentGroupType?[t.groupServiceList.includes(i.service_id)?e("p-box-item",{key:"service-"+s,attrs:{id:"service-"+s,item:i,"item-name":i.service_name,"item-price":i.price,clicked:t.chooseService}}):t._e()]:t._e()]}))],2),"item"===t.currentGroupType&&0!==t.itemList.length?e("p-pagination",{attrs:{"current-page":t.currentPageItem,"last-page":t.lastPageItem},on:{updatePageItem:t.updatePageItem}}):t._e(),"service"===t.currentGroupType&&0!==t.serviceList.length?e("p-pagination",{attrs:{"current-page":t.currentPageService,"last-page":t.lastPageService},on:{updatePageService:t.updatePageService}}):t._e()],1)],1),e("div",{staticClass:"col-sm-4",staticStyle:{"background-color":"LightGray"}},[e("p-table",{staticStyle:{"margin-bottom":"0px"}},[e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",[t._v(" "+t._s(t._f("titlecase")(t.$t("customer")))+" ")]),e("td",{staticStyle:{"text-align":"right"}},[e("div",{staticStyle:{"text-align":"right"},attrs:{slot:"body"},slot:"body"},[e("m-customer",{attrs:{id:"customer"},on:{choosen:t.chooseCustomer},model:{value:t.form.customer_id,callback:function(e){t.$set(t.form,"customer_id",e)},expression:"form.customer_id"}})],1)])]),t._l(t.form.items_temporary,(function(i,s){return[e("tr",{key:"item-select-"+s,staticStyle:{cursor:"pointer"},attrs:{slot:"p-body"},on:{click:function(e){return t.showItem(s,i)}},slot:"p-body"},[e("td",{staticStyle:{"text-align":"left"},attrs:{width:"75%"}},[[e("label",{staticStyle:{cursor:"pointer",color:"blue"}},[t._v(t._s(t._f("numberFormat")(i.quantity))+"x")]),t._v(" "+t._s(t._f("numberFormat")(i.price))+" ")],e("br"),e("b",[t._v(t._s(i.item_name)+" ("+t._s(i.item_unit.label)+")")]),i.discount_percent>0?[e("br"),e("label",{staticStyle:{cursor:"pointer",color:"orange"}},[t._v(t._s(t._f("numberFormat")(i.discount_percent))+"% Discount")])]:t._e(),i.error?[e("br"),e("label",{staticStyle:{cursor:"pointer",color:"red"}},[t._v(t._s(i.error))])]:t._e(),i.notes?[e("br"),e("br"),e("label",{staticStyle:{cursor:"pinter"}},[t._v("Note: "+t._s(i.notes))])]:t._e()],2),e("td",{staticStyle:{"text-align":"right"},attrs:{width:"25%"}},[e("b",[t._v(t._s(t._f("numberFormat")(i.total)))])])])]})),t._l(t.form.services,(function(i,s){return e("tr",{key:"service-select-"+s,staticStyle:{cursor:"pointer"},attrs:{slot:"p-body"},on:{click:function(e){return t.showService(s,i)}},slot:"p-body"},[e("td",{staticStyle:{"text-align":"left"},attrs:{width:"75%"}},[[e("label",{staticStyle:{cursor:"pointer",color:"blue"}},[t._v(t._s(t._f("numberFormat")(i.quantity))+"x")]),t._v(" "+t._s(t._f("numberFormat")(i.price))+" ")],e("br"),e("b",[t._v(t._s(i.service_name))]),i.discount_percent>0?[e("br"),e("label",{staticStyle:{cursor:"pointer",color:"orange"}},[t._v(t._s(t._f("numberFormat")(i.discount_percent))+"% Discount")])]:t._e(),i.error?[e("br"),e("label",{staticStyle:{cursor:"pointer",color:"red"}},[t._v(t._s(i.error))])]:t._e(),i.notes?[e("br"),e("br"),e("label",{staticStyle:{cursor:"pinter"}},[t._v("Note: "+t._s(i.notes))])]:t._e()],2),e("td",{staticStyle:{"text-align":"right"},attrs:{width:"25%"}},[e("b",[t._v(t._s(t._f("numberFormat")(i.total)))])])])})),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",[t._v(" "+t._s(t._f("titlecase")(t.$t("total items")))+" ")]),e("td",{staticStyle:{"text-align":"right"}},[e("b",[t._v(t._s(t._f("numberFormat")(t.form.total_quantity)))])])]),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",[t._v(" "+t._s(t._f("titlecase")(t.$t("sub total")))+" ")]),e("td",{staticStyle:{"text-align":"right"}},[e("b",[t._v(t._s(t._f("numberFormat")(t.form.subtotal)))])])]),e("tr",{staticStyle:{cursor:"pointer"},attrs:{slot:"p-body"},on:{click:function(e){return t.showDiscount()}},slot:"p-body"},[e("td",[t._v(" "+t._s(t._f("titlecase")(t.$t("discount")))+" ")]),e("td",{staticStyle:{"text-align":"right"}},[t.form.discount_percent?[e("b",[t._v(t._s(t._f("numberFormat")(t.form.discount_percent))+"%")])]:[e("b",[t._v("+")])]],2)]),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",[t._v(" "+t._s(t._f("titlecase")(t.$t("total")))+" ")]),e("td",{staticStyle:{"text-align":"right"}},[e("b",[t._v(t._s(t._f("numberFormat")(t.form.amount)))])])]),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",[t._v(" "+t._s(t._f("titlecase")(t.$t("money received")))+" ")]),e("td",{staticStyle:{"text-align":"right"}},[e("div",{staticStyle:{"text-align":"right"},attrs:{slot:"body"},slot:"body"},[e("p-form-number",{attrs:{id:"paid",name:"paid",readonly:t.isSaving||t.isLoading||t.isGroupLoading},nativeOn:{keyup:function(e){return t.calculate()}},model:{value:t.form.paid,callback:function(e){t.$set(t.form,"paid",e)},expression:"form.paid"}})],1)])]),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",[t._v(" "+t._s(t._f("titlecase")(t.$t("money change")))+" ")]),e("td",{staticStyle:{"text-align":"right"}},[t.form.change<0?e("b",{staticStyle:{color:"red"}},[t._v(t._s(t._f("numberFormat")(t.form.change)))]):e("b",{staticStyle:{color:"green"}},[t._v(t._s(t._f("numberFormat")(t.form.change)))])])])],2),e("p-form-row",{attrs:{id:"notes",name:"notes",label:t.$t("notes")}},[e("div",{staticClass:"col-lg-12 mt-5",attrs:{slot:"body"},slot:"body"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.notes,expression:"form.notes"}],staticClass:"form-control",attrs:{rows:"5",placeholder:"Notes",readonly:t.isSaving},domProps:{value:t.form.notes},on:{input:function(e){e.target.composing||t.$set(t.form,"notes",e.target.value)}}})])]),e("div",{staticClass:"form-group row"},[e("div",{staticClass:"col-md-12"},[0!==t.form.items_temporary.length||0!==t.form.services.length?e("button",{staticClass:"btn btn-block btn-success",attrs:{type:"button",disabled:t.isSaving||t.isLoading||t.isGroupLoading},on:{click:t.charge}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" Charge "+t._s(t._f("numberFormat")(t.form.amount))+" ")]):t._e(),0!==t.form.items_temporary.length||0!==t.form.services.length?e("button",{staticClass:"btn btn-block btn-primary",attrs:{type:"button",disabled:t.isSaving||t.isLoading||t.isGroupLoading},on:{click:t.save}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("save")))+" ")]):t._e()])])],1)])])],1)],1),e("discount-modal",{ref:"discount",attrs:{id:"discount"},on:{updateDiscount:t.updateDiscount}}),e("item-modal",{ref:"item",attrs:{id:"item"},on:{updateItem:t.updateItem,deleteItem:t.deleteItem}}),e("service-modal",{ref:"service",attrs:{id:"service"},on:{updateService:t.updateService,deleteService:t.deleteService}}),e("warehouse-modal",{ref:"warehouse",attrs:{id:"warehouse"},on:{updateWarehouse:t.updateWarehouse}}),e("m-inventory-out",{key:"inventory",ref:"inventory",attrs:{id:"inventory","item-id":t.selectedItem.item_id,"require-expiry-date":t.selectedItem.require_expiry_date,"require-production-number":t.selectedItem.require_production_number,"warehouse-id":t.form.warehouse_id,inventories:t.selectedItem.inventories,"is-pos":!0,"item-name":t.selectedItem.item_name,"item-price":t.selectedItem.price,"item-unit":t.selectedItem.item_unit},on:{add:function(e){return t.addInventory(e,t.selectedItem)}}})],1)},r=[],o=i("5530"),n=(i("d3b7"),i("159b"),i("14d9"),i("3ca3"),i("ddb0"),i("c740"),i("a434"),i("5ae6")),a=i("0e0d"),c=i("b7ae"),u=i("54b6"),l=i("9887"),d=i("4ced"),m=function(){var t=this,e=t._self._c;return e("div",[e("form",{staticClass:"row",on:{submit:function(e){return e.preventDefault(),t.onSubmitWarehouse.apply(null,arguments)}}},[e("p-modal",{ref:"warehouseModal",attrs:{id:"warehouseModal","can-close":!1,title:t._f("uppercase")(t.title)}},[e("template",{slot:"content"},[t.isLoading?e("div",[e("h5",{staticClass:"text-center"},[t._v(" Loading ... ")])]):e("div",{staticClass:"list-group push"},[e("div",{staticClass:"list-group"},[t._l(t.user.warehouses,(function(i,s){return[e("a",{key:s,staticClass:"list-group-item list-group-item-action d-flex justify-content-between align-items-center",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.onSubmitWarehouse(i,s)}}},[e("span",[e("i",{staticClass:"fa fa-fw fa-hand-o-right mr-5"}),t._v(" "+t._s(t._f("titlecase")(i.name)))])])]}))],2)]),0!=t.user.warehouses.length||t.isLoading?t._e():e("div",{staticClass:"alert alert-info text-center"},[t._v(" "+t._s(t._f("capitalize")(t.$t("you don't have access to any")))+" "+t._s(t._f("capitalize")(t.$t("warehouse")))+" "),e("br"),e("router-link",{attrs:{to:"/master/user/"}},[e("span",[t._v(t._s(t._f("capitalize")(t.$t("add access to")))+" "+t._s(t._f("capitalize")(t.$t("warehouse"))))])])],1)])],2)],1)])},p=[],_=(i("7db0"),i("2f62")),h={props:{id:{type:String,required:!0}},data:function(){return{title:"Warehouse",isLoading:!1,userId:localStorage.getItem("userId")}},computed:Object(o["a"])({},Object(_["c"])("masterUser",["user"])),methods:Object(o["a"])(Object(o["a"])({},Object(_["b"])("masterUser",["find"])),{},{show:function(){var t=this;this.isLoading=!0,this.$refs.warehouseModal.show(),this.find({id:localStorage.getItem("userId"),params:{includes:"warehouses"}}).then((function(e){var i=t.user.warehouses.findIndex((function(t){return t.id===parseInt(localStorage.getItem("defaultWarehouse"))}));i>=0&&t.onSubmitWarehouse(t.user.warehouses[i]),t.isLoading=!1}),(function(e){console.log(e.message),t.isLoading=!1}))},onSubmitWarehouse:function(t){localStorage.setItem("defaultWarehouse",t.id),this.$emit("updateWarehouse",{warehouseId:t.id}),this.$refs.warehouseModal.close()}})},f=h,v=i("2877"),g=Object(v["a"])(f,m,p,!1,null,null,null),b=g.exports,y=i("b047"),S=i.n(y),x={components:{Breadcrumb:n["a"],BreadcrumbPos:a["a"],DiscountModal:u["a"],ItemModal:l["a"],ServiceModal:d["a"],WarehouseModal:b},data:function(){return{isSaving:!1,isLoading:!1,isGroupLoading:!1,searchText:"",currentGroup:null,currentGroupType:null,itemList:[],serviceList:[],groupItemList:[],groupServiceList:[],currentPageItem:1*this.$route.query.pageItem||1,currentPageService:1*this.$route.query.pageService||1,lastPageItem:1,lastPageService:1,form:new c["a"]({increment_group:this.$moment().format("YYYYMM"),date:this.$moment().format("YYYY-MM-DD HH:mm:ss"),customer_id:null,customer_name:null,pricing_group_id:-1,approver_id:null,notes:null,subtotal:0,discount_percent:0,discount_value:0,tax_base:0,tax:0,type_of_tax:"exclude",total_quantity:0,amount:0,paid:0,change:0,items_temporary:[],items:[],services:[],is_done:0,warehouse_id:0}),selectedItem:{item_id:0,item_name:null,item_unit:null,item_unit_id:0,unit:null,converter:0,quantity:0,price:0,discount_value:0,discount_percent:0,total:0,pricing_group_id:-1,notes:null,error:null,stock:0,require_expiry_date:0,require_production_number:0,inventories:[]}}},computed:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(_["c"])("masterCustomer",["customer"])),Object(_["c"])("masterItemGroup",{itemGroups:"groups"})),Object(_["c"])("masterServiceGroup",{serviceGroups:"groups"})),Object(_["c"])("masterPriceListItem",{items:"items",paginationItem:"pagination"})),Object(_["c"])("masterPriceListService",{services:"services",paginationService:"pagination"})),watch:{currentGroup:function(){var t=this;this.currentGroup&&("item"===this.currentGroupType?(this.groupItemList=[],this.currentGroup.items.forEach((function(e){t.groupItemList.push(e.id)}))):"service"===this.currentGroupType&&(this.groupServiceList=[],this.currentGroup.services.forEach((function(e){t.groupServiceList.push(e.id)}))),this.updateDisplayedData())},"form.customer_id":function(){var t=this;this.form.customer_id&&!this.isLoading&&(this.isLoading=!0,this.findCustomer({id:this.form.customer_id}).then((function(e){t.form.pricing_group_id=t.customer.pricing_group_id||-1,t.requestPriceListData()})).catch((function(e){t.$notification.error(e.message)})))}},created:function(){this.isGroupLoading=!0},mounted:function(){this.form.warehouse_id=localStorage.getItem("defaultWarehouse"),this.$refs.warehouse.show()},updated:function(){0!==this.itemList.length&&(this.lastPageItem=this.paginationItem.last_page),0!==this.serviceList.length&&(this.lastPageService=this.paginationService.last_page)},methods:Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])(Object(o["a"])({},Object(_["b"])("masterCustomer",{findCustomer:"find"})),Object(_["b"])("masterItemGroup",{getItemGroups:"get"})),Object(_["b"])("masterServiceGroup",{getServiceGroups:"get"})),Object(_["b"])("masterPriceListItem",{getPriceListItem:"get"})),Object(_["b"])("masterPriceListService",{getPriceListService:"get"})),Object(_["b"])("posBill",["create"])),{},{getItemGroupRequest:function(){return this.getItemGroups({params:{includes:"items"}})},getServiceGroupRequest:function(){return this.getServiceGroups({params:{includes:"services"}})},getItemRequest:function(){return this.getPriceListItem({params:{filter_like:{name:this.searchText,"units.label":this.searchText},pricing_group_id:this.form.pricing_group_id,filter_has:"units,units.prices",includes:"units;units.prices",sort_by:"items.name",page:this.currentPageItem}})},getServiceRequest:function(){return this.getPriceListService({params:{filter_like:{name:this.searchText},pricing_group_id:this.form.pricing_group_id,filter_has:"prices",includes:"prices",sort_by:"services.name",page:this.currentPageService}})},requestAllData:function(){var t=this;this.isGroupLoading=!0,Promise.all([this.getItemGroupRequest(),this.getServiceGroupRequest(),this.getItemRequest(),this.getServiceRequest()]).then((function(e){t.itemGroups.forEach((function(e){t.currentGroup||(t.currentGroup=e,t.currentGroupType="item")})),t.serviceGroups.forEach((function(e){t.currentGroup||(t.currentGroup=e,t.currentGroupType="service")})),t.isGroupLoading=!1})).catch((function(e){t.isGroupLoading=!1,t.$notification.error(e.message)}))},requestPriceListData:function(){var t=this;this.isLoading=!0,Promise.all([this.getItemRequest(),this.getServiceRequest()]).then((function(e){t.updateDisplayedData(),t.isLoading=!1})).catch((function(e){t.isLoading=!1,t.$notification.error(e.message)}))},filterSearch:S()((function(t){this.currentPageItem=1,this.currentPageService=1,this.requestPriceListData()}),300),updatePageItem:function(t){this.currentPageItem=t,this.requestPriceListData()},updatePageService:function(t){this.currentPageService=t,this.requestPriceListData()},selectGroup:function(t,e){this.isSaving||this.isLoading||this.isGroupLoading||(this.currentGroup=t,this.currentGroupType=e)},chooseCustomer:function(t){this.form.customer_name=t},chooseItem:function(t){var e=this.form.items_temporary.findIndex((function(e){return e.item_id===t.item_id&&e.item_unit.label===t.item_unit.label}));if(e>=0){var i=this.form.items_temporary[e];this.selectedItem=Object.assign({},i),t.require_expiry_date||t.require_production_number?this.$refs.inventory.show(this.selectedItem):(i.quantity+=1,this.$set(this.form.items_temporary,e,i))}else{var s=Object.assign({},t);this.selectedItem=Object.assign({},s),t.require_expiry_date||t.require_production_number?this.$refs.inventory.show(this.selectedItem):(s.quantity=1,s.inventories=[],this.form.items_temporary.push(s))}this.calculate()},chooseService:function(t){var e=this.form.services.findIndex((function(e){return e.service_id===t.service_id}));if(e>=0){var i=this.form.services[e];i.quantity+=1,this.$set(this.form.services,e,i)}else{var s=t;s.quantity=1,this.form.services.push(s)}this.calculate()},addInventory:function(t,e){if(t.quantity>0){var i=this.form.items_temporary.findIndex((function(t){return t.item_id===e.item_id&&t.item_unit.label===e.item_unit.label}));if(i>=0){var s=this.form.items_temporary[i];s.quantity=t.quantity,s.inventories=t.inventories,s.notes=t.notes,s.discount_percent=t.discountPercent,this.$set(this.form.items_temporary,i,s)}else{var r=Object.assign({},e);r.quantity=t.quantity,r.inventories=t.inventories,r.notes=t.notes,r.discount_percent=t.discountPercent,this.form.items_temporary.push(r)}this.updateDisplayedData()}},showDiscount:function(){this.isSaving||this.isLoading||this.isGroupLoading||this.$refs.discount.show(this.form.discount_percent)},showItem:function(t,e){this.isSaving||this.isLoading||this.isGroupLoading||(this.selectedItem=Object.assign({},e),e.require_expiry_date||e.require_production_number?this.$refs.inventory.show(this.selectedItem):this.$refs.item.show(t,e))},showService:function(t,e){this.isSaving||this.isLoading||this.isGroupLoading||this.$refs.service.show(t,e)},updateDiscount:function(t){this.form.discount_percent=t.discount_percent,this.calculate()},updateItem:function(t){var e=t.item,i=this.form.items_temporary[e.index];i&&(e.quantity>0?(i.quantity=e.quantity,i.discount_percent=e.discount_percent||0,i.notes=e.notes,this.$set(this.form.items_temporary,e.index,i)):this.form.items_temporary.splice(e.index,1),this.calculate())},updateService:function(t){var e=t.service,i=this.form.services[e.index];i&&(e.quantity>0?(i.quantity=e.quantity,i.discount_percent=e.discount_percent||0,i.notes=e.notes,this.$set(this.form.services,e.index,i)):this.form.services.splice(e.index,1),this.calculate())},updateWarehouse:function(t){this.form.warehouse_id=t.warehouseId,this.requestAllData()},deleteItem:function(t){var e=t.item,i=this.form.items_temporary[e.index];i&&(this.form.items_temporary.splice(e.index,1),this.calculate())},deleteService:function(t){var e=t.service,i=this.form.services[e.index];i&&(this.form.services.splice(e.index,1),this.calculate())},updateDisplayedData:function(){var t=this;this.itemList=[],this.serviceList=[],this.items.forEach((function(e){e.units.forEach((function(i){i.prices.forEach((function(s){if(0!==s.price&&(-1===t.form.pricing_group_id&&s.pricing_group_id&&(t.form.pricing_group_id=s.pricing_group_id),t.form.pricing_group_id&&t.form.pricing_group_id===s.pricing_group_id)){var r={item_id:e.id,item_name:e.name,item_unit:i,item_unit_id:i.id,unit:i.label,converter:i.converter,quantity:0,price:s.price,discount_value:0,discount_percent:0,total:0,pricing_group_id:s.pricing_group_id,notes:null,error:null,stock:e.stock,require_expiry_date:e.require_expiry_date,require_production_number:e.require_production_number};t.itemList.push(r)}}))}))})),this.services.forEach((function(e){e.prices.forEach((function(i){if(0!==i.price&&(-1===t.form.pricing_group_id&&i.pricing_group_id&&(t.form.pricing_group_id=i.pricing_group_id),t.form.pricing_group_id&&t.form.pricing_group_id===i.pricing_group_id)){var s={service_id:e.id,service_name:e.name,quantity:0,price:i.price,discount_value:0,discount_percent:0,total:0,pricing_group_id:i.pricing_group_id,notes:null,error:null};t.serviceList.push(s)}}))})),this.form.items_temporary.forEach((function(e){e.pricing_group_id=t.form.pricing_group_id})),this.form.services.forEach((function(e){e.pricing_group_id=t.form.pricing_group_id})),this.form.items_temporary.forEach((function(e){var i=t.itemList.findIndex((function(t){return t.item_id===e.item_id&&t.item_unit.label===e.item_unit.label&&t.pricing_group_id==e.pricing_group_id}));i>=0?(e.price=t.itemList[i].price,t.itemList[i].inventories=e.inventories,e.error=null):e.error="Item not Available"})),this.form.services.forEach((function(e){var i=t.serviceList.findIndex((function(t){return t.service_id===e.service_id&&t.pricing_group_id==e.pricing_group_id}));i>=0?(e.price=t.serviceList[i].price,e.error=null):e.error="Item not Available"})),this.calculate()},calculate:S()((function(t){var e=this;this.form.subtotal=0,this.form.total_quantity=0,this.form.items_temporary.forEach((function(t){t.discount_value=parseFloat(t.price)*parseFloat(t.discount_percent)/100,t.total=parseFloat(t.quantity)*(parseFloat(t.price)-parseFloat(t.discount_value)),e.form.subtotal+=parseFloat(t.total),e.form.total_quantity+=parseFloat(t.quantity)})),this.form.services.forEach((function(t){t.discount_value=parseFloat(t.price)*parseFloat(t.discount_percent)/100,t.total=parseFloat(t.quantity)*(parseFloat(t.price)-parseFloat(t.discount_value)),e.form.subtotal+=parseFloat(t.total),e.form.total_quantity+=parseFloat(t.quantity)})),this.form.discount_value=this.form.subtotal*this.form.discount_percent/100,this.form.tax_base=this.form.subtotal-this.form.discount_value,this.form.tax=10*this.form.tax_base/100,this.form.amount=this.form.tax_base+this.form.tax,this.form.change=parseFloat(this.form.paid)-parseFloat(this.form.amount)}),100),validate:function(){var t=this;if(0===this.form.items_temporary.length&&0===this.form.services.length)return this.$notification.error("Please Add at least one Item or Service"),!1;var e=!0;return this.form.items_temporary.forEach((function(i){var s=t.itemList.findIndex((function(t){return t.item_id===i.item_id&&t.item_unit.label===i.item_unit.label&&t.pricing_group_id==i.pricing_group_id}));s<0&&(e=!1)})),this.form.services.forEach((function(i){var s=t.serviceList.findIndex((function(t){return t.service_id===i.service_id&&t.pricing_group_id==i.pricing_group_id}));s<0&&(e=!1)})),!!e||(this.$notification.error("Item not Available"),!1)},setItems:function(){for(var t in this.form.items=[],this.form.items_temporary){var e=this.form.items_temporary[t];if(e.inventories.length>0)for(var i in e.inventories){var s=e.inventories[i];if(s.quantity){var r=Object.assign({},e);r.quantity=s.quantity,r.expiry_date=s.expiry_date,r.production_number=s.production_number,this.form.items.push(r)}}else this.form.items.push(e)}},save:function(){var t=this;this.validate()&&(this.isSaving=!0,this.form.is_done=0,this.setItems(),this.create(this.form).then((function(e){t.isSaving=!1,t.$notification.success("save success"),t.reset()})).catch((function(e){t.isSaving=!1,t.$notification.error(e.message),t.form.errors.record(e.errors)})))},charge:function(){var t=this;if(this.validate()){if(this.calculate(),this.form.paid<this.form.amount)return void this.$notification.error("Please Pay the Amount Correctly");this.isSaving=!0,this.form.is_done=1,this.setItems(),this.create(this.form).then((function(e){t.isSaving=!1,t.$notification.success("charge success"),t.reset()})).catch((function(e){t.isSaving=!1,t.$notification.error(e.message),t.form.errors.record(e.errors)}))}},reset:function(){this.form.increment_group=this.$moment().format("YYYYMM"),this.form.date=this.$moment().format("YYYY-MM-DD HH:mm:ss"),this.form.customer_id=null,this.form.customer_name=null,this.form.pricing_group_id=-1,this.form.approver_id=null,this.form.notes=null,this.form.subtotal=0,this.form.discount_percent=0,this.form.discount_value=0,this.form.tax_base=0,this.form.tax=0,this.form.type_of_tax="exclude",this.form.total_quantity=0,this.form.amount=0,this.form.paid=0,this.form.change=0,this.form.items_temporary=[],this.form.items=[],this.form.services=[],this.form.is_done=0}})},w=x,q=Object(v["a"])(w,s,r,!1,null,null,null);e["default"]=q.exports}}]);
//# sourceMappingURL=chunk-4dcd6272.7eff9fed.js.map
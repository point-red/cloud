(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01e580c2"],{"0e0d":function(t,e,r){"use strict";var i=function(){var t=this,e=t._self._c;return e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/pos"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("pos")))+" ")])},s=[],o=r("2877"),a={},l=Object(o["a"])(a,i,s,!1,null,null,null);e["a"]=l.exports},1025:function(t,e,r){"use strict";r.r(e);r("b0c0");var i=function(){var t=this,e=t._self._c;return e("div",[e("breadcrumb",[e("breadcrumb-pos"),e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/pos/closed-bill"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("closed bill")))+" ")]),e("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t.id))])],1),e("p-block",{attrs:{header:!0,title:t.$t("bill")+" ("+t.bill.form.number+")","is-fullscreen":!0,"show-fullscreen-button":!1,"show-hidden-button":!1,column:"col-sm-12"},scopedSlots:t._u([{key:"header",fn:function(){return[t._v(" |"),t.$permission.has("create pos")?e("router-link",{attrs:{to:"/pos/open-bill/create",exact:""}},[e("button",{staticClass:"btn-block-option",attrs:{type:"button"}},[t._v(" Add ")])]):t._e(),t._v("| "),t.$permission.has("read pos")?e("router-link",{attrs:{to:"/pos/closed-bill",exact:""}},[e("button",{staticClass:"btn-block-option",attrs:{type:"button"}},[t._v(" List ")])]):t._e(),t._v("| ")]},proxy:!0}])},[e("p-block-inner",{attrs:{"is-loading":t.isLoading}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3 col-lg-3"}),e("div",{staticClass:"col-sm-12 col-md-6 col-lg6",staticStyle:{"background-color":"LightGray"}},[e("p-table",{staticStyle:{"margin-top":"30px","margin-bottom":"10px"}},[e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"},attrs:{width:"50%"}},[e("b",[t._v(t._s(t.bill.form.number))])]),e("td",{staticStyle:{border:"0px","text-align":"right"},attrs:{width:"50%"}},[e("b",[t._v(t._s(t._f("dateFormat")(t.bill.date,"DD MMMM YYYY HH:mm")))])])]),t.bill.customer?e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"},attrs:{colspan:"2"}},[t._v(" Customer: "),e("b",[t._v(t._s(t.bill.customer.name))])])]):t._e(),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"},attrs:{colspan:"2"}},[e("br")])]),t._l(t.items_temporary,(function(r,i){return[1===r.require_expiry_date||1===r.require_production_number?e("tr",{key:"item-"+i,staticStyle:{cursor:"pointer"},attrs:{slot:"p-body"},on:{click:function(e){return t.showItem(i,r)}},slot:"p-body"},[e("td",{staticStyle:{border:"0px","text-align":"left"},attrs:{width:"75%"}},[[e("label",{staticStyle:{color:"blue"}},[t._v(t._s(t._f("numberFormat")(r.quantity))+"x")]),t._v(" "+t._s(t._f("numberFormat")(r.price))+" ")],e("br"),e("b",[t._v(t._s(r.item_name)+" ("+t._s(r.unit)+")")]),r.discount_percent>0?[e("br"),e("label",{staticStyle:{color:"orange"}},[t._v(t._s(t._f("numberFormat")(r.discount_percent))+"% Discount")])]:t._e(),r.error?[e("br"),e("label",{staticStyle:{color:"red"}},[t._v(t._s(r.error))])]:t._e(),r.notes?[e("br"),e("br"),e("label",[t._v("Note: "+t._s(r.notes))])]:t._e()],2),e("td",{staticStyle:{border:"0px","text-align":"right"},attrs:{width:"25%"}},[e("b",[t._v(t._s(t._f("numberFormat")(r.total)))])])]):e("tr",{key:"item-"+i,attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px","text-align":"left"},attrs:{width:"75%"}},[[e("label",{staticStyle:{color:"blue"}},[t._v(t._s(t._f("numberFormat")(r.quantity))+"x")]),t._v(" "+t._s(t._f("numberFormat")(r.price))+" ")],e("br"),e("b",[t._v(t._s(r.item_name)+" ("+t._s(r.unit)+")")]),r.discount_percent>0?[e("br"),e("label",{staticStyle:{color:"orange"}},[t._v(t._s(t._f("numberFormat")(r.discount_percent))+"% Discount")])]:t._e(),r.error?[e("br"),e("label",{staticStyle:{color:"red"}},[t._v(t._s(r.error))])]:t._e(),r.notes?[e("br"),e("br"),e("label",[t._v("Note: "+t._s(r.notes))])]:t._e()],2),e("td",{staticStyle:{border:"0px","text-align":"right"},attrs:{width:"25%"}},[e("b",[t._v(t._s(t._f("numberFormat")(r.total)))])])])]})),t._l(t.bill.services,(function(r,i){return e("tr",{key:"service-"+i,attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px","text-align":"left"},attrs:{width:"75%"}},[[e("label",{staticStyle:{color:"blue"}},[t._v(t._s(t._f("numberFormat")(r.quantity))+"x")]),t._v(" "+t._s(t._f("numberFormat")(r.price))+" ")],e("br"),e("b",[t._v(t._s(r.service_name))]),r.discount_percent>0?[e("br"),e("label",{staticStyle:{color:"orange"}},[t._v(t._s(t._f("numberFormat")(r.discount_percent))+"% Discount")])]:t._e(),r.error?[e("br"),e("label",{staticStyle:{color:"red"}},[t._v(t._s(r.error))])]:t._e(),r.notes?[e("br"),e("br"),e("label",[t._v("Note: "+t._s(r.notes))])]:t._e()],2),e("td",{staticStyle:{border:"0px","text-align":"right"},attrs:{width:"25%"}},[e("b",[t._v(t._s(t._f("numberFormat")(r.total)))])])])})),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"},attrs:{colspan:"2"}},[e("br")])]),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"}},[e("b",[t._v(t._s(t._f("titlecase")(t.$t("total items"))))])]),e("td",{staticStyle:{border:"0px","text-align":"right"}},[e("b",[t._v(t._s(t._f("numberFormat")(t.bill.total_quantity)))])])]),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"}},[e("b",[t._v(t._s(t._f("titlecase")(t.$t("sub total"))))])]),e("td",{staticStyle:{border:"0px","text-align":"right"}},[e("b",[t._v(t._s(t._f("numberFormat")(t.bill.subtotal)))])])]),t.bill.discount_percent?e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"}},[e("b",[t._v(t._s(t._f("titlecase")(t.$t("discount"))))])]),e("td",{staticStyle:{border:"0px","text-align":"right"}},[e("b",[t._v(t._s(t._f("numberFormat")(t.bill.discount_percent))+"%")])])]):t._e(),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"}},[e("b",[t._v(t._s(t._f("titlecase")(t.$t("total"))))])]),e("td",{staticStyle:{border:"0px","text-align":"right"}},[e("b",[t._v(t._s(t._f("numberFormat")(t.bill.amount)))])])]),t.bill.paid?e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"}},[e("b",[t._v(t._s(t._f("titlecase")(t.$t("money received"))))])]),e("td",{staticStyle:{border:"0px","text-align":"right"}},[e("b",[t._v(t._s(t._f("numberFormat")(t.bill.paid)))])])]):t._e(),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"}},[e("b",[t._v(t._s(t._f("titlecase")(t.$t("money change"))))])]),e("td",{staticStyle:{border:"0px","text-align":"right"}},[t.bill.change<0?e("b",{staticStyle:{color:"red"}},[t._v(t._s(t._f("numberFormat")(t.bill.change)))]):e("b",{staticStyle:{color:"green"}},[t._v(t._s(t._f("numberFormat")(t.bill.change)))])])]),t.bill.notes?e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[e("td",{staticStyle:{border:"0px"},attrs:{colspan:"2"}},[e("b",[t._v(t._s(t._f("titlecase")(t.$t("notes")))+":")]),e("br"),t._v(" "+t._s(t.bill.notes)+" ")])]):t._e(),e("tr",{attrs:{slot:"p-body"},slot:"p-body"},[t.bill.form.created_by?e("td",{staticStyle:{border:"0px"},attrs:{colspan:"2"}},[t._v(" Billed by "),e("b",[t._v(t._s(t.bill.form.created_by.name))])]):t._e()])],2),t.$permission.has("delete pos")?e("button",{staticClass:"btn btn-block btn-danger",staticStyle:{"margin-bottom":"30px"},attrs:{type:"button",disabled:t.isDeleting},on:{click:t.onDelete}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isDeleting,expression:"isDeleting"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("delete")))+" ")]):t._e()],1)])])],1),e("m-inventory",{key:"inventory",ref:"inventory",attrs:{id:"inventory","is-pos":!0,"item-unit":t.selectedItem.unit,inventories:t.selectedItem.inventories,"require-expiry-date":t.selectedItem.require_expiry_date,"require-production-number":t.selectedItem.require_production_number}})],1)},s=[],o=r("5530"),a=(r("c740"),r("14d9"),r("d3b7"),r("159b"),r("5ae6")),l=r("0e0d"),n=r("2f62"),c={components:{Breadcrumb:a["a"],BreadcrumbPos:l["a"]},data:function(){return{id:this.$route.params.id,isLoading:!1,isDeleting:!1,items_temporary:[],selectedItem:{unit:null,inventories:[],require_expiry_date:0,require_production_number:0}}},computed:Object(o["a"])({},Object(n["c"])("posBill",["bill"])),watch:{$route:function(t,e){t.params.id!=e.params.id&&(this.id=t.params.id,this.posBillRequest())}},created:function(){this.isLoading=!0,this.posBillRequest()},methods:Object(o["a"])(Object(o["a"])({},Object(n["b"])("posBill",{findBill:"find",deleteBill:"delete"})),{},{posBillRequest:function(){var t=this;this.isLoading=!0,this.findBill({id:this.id,params:{filter_form:"activeDone",includes:"form;customer;items.item;services.service;form.createdBy"}}).then((function(e){t.items_temporary=[];var r=function(e){var r=t.bill.items[e],i=t.items_temporary.findIndex((function(t){return t.item_id===r.item_id&&t.unit===r.unit}));i<0?(s=Object.assign({},r),s.inventories=[],s.require_expiry_date=r.item.require_expiry_date,s.require_production_number=r.item.require_production_number,s.inventories.push({quantity:r.quantity,expiry_date:r.expiry_date,production_number:r.production_number}),t.items_temporary.push(s)):(o=t.items_temporary[i],o.quantity+=r.quantity,o.inventories.push({quantity:r.quantity,expiry_date:r.expiry_date,production_number:r.production_number}),t.items_temporary[i]=o)};for(var i in t.bill.items){var s,o;r(i)}t.isLoading=!1,t.calculate()})).catch((function(e){t.isLoading=!1,t.$notification.error(e.message)}))},calculate:function(){var t=this;this.bill.subtotal=0,this.bill.total_quantity=0,this.items_temporary.forEach((function(e){e.discount_value=parseFloat(e.price)*parseFloat(e.discount_percent)/100,e.total=parseFloat(e.quantity)*(parseFloat(e.price)-parseFloat(e.discount_value)),t.bill.subtotal+=parseFloat(e.total),t.bill.total_quantity+=parseFloat(e.quantity)})),this.bill.services.forEach((function(e){e.discount_value=parseFloat(e.price)*parseFloat(e.discount_percent)/100,e.total=parseFloat(e.quantity)*(parseFloat(e.price)-parseFloat(e.discount_value)),t.bill.subtotal+=parseFloat(e.total),t.bill.total_quantity+=parseFloat(e.quantity)})),this.bill.change=parseFloat(this.bill.paid)-parseFloat(this.bill.amount)},showItem:function(t,e){this.isLoading||this.isDeleting||(this.selectedItem=Object.assign({},e),(e.require_expiry_date||e.require_production_number)&&this.$refs.inventory.show(this.selectedItem))},onDelete:function(){var t=this;this.isDeleting=!0,this.deleteBill({id:this.id}).then((function(e){t.isDeleting=!1,t.$notification.success("delete success"),t.$router.push("/pos/closed-bill")})).catch((function(e){t.isDeleting=!1,t.$notification.error(e.message)}))}})},b=c,d=r("2877"),_=Object(d["a"])(b,i,s,!1,null,null,null);e["default"]=_.exports}}]);
//# sourceMappingURL=chunk-01e580c2.ea910c79.js.map
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38372501"],{"055b":function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex flex-nowrap",staticStyle:{"overflow-x":"auto"}},[e("router-link",{staticClass:"btn mr-5 mb-15",class:{"btn-secondary":!t.isMatch("/purchase/request")},attrs:{to:"/purchase/request","active-class":"btn-primary"}},[e("span",[t._v(t._s(t._f("uppercase")(t.$t("purchase request"))))])]),e("router-link",{staticClass:"btn mr-5 mb-15",class:{"btn-secondary":!t.isMatch("/purchase/order")},attrs:{to:"/purchase/order","active-class":"btn-primary"}},[e("span",[t._v(t._s(t._f("uppercase")(t.$t("purchase order"))))])]),e("router-link",{staticClass:"btn mr-5 mb-15",class:{"btn-secondary":!t.isMatch("/purchase/down-payment")},attrs:{to:"/purchase/down-payment","active-class":"btn-primary"}},[e("span",[t._v(t._s(t._f("uppercase")(t.$t("down payment"))))])]),e("router-link",{staticClass:"btn mr-5 mb-15",class:{"btn-secondary":!t.isMatch("/purchase/receive")},attrs:{to:"/purchase/receive","active-class":"btn-primary"}},[e("span",[t._v(t._s(t._f("uppercase")(t.$t("purchase receive"))))])]),e("router-link",{staticClass:"btn mr-5 mb-15",class:{"btn-secondary":!t.isMatch("/purchase/invoice")},attrs:{to:"/purchase/invoice","active-class":"btn-primary"}},[e("span",[t._v(t._s(t._f("uppercase")(t.$t("purchase invoice"))))])]),e("router-link",{staticClass:"btn mr-5 mb-15",class:{"btn-secondary":!t.isMatch("/purchase/payment-order")},attrs:{to:"/purchase/payment-order","active-class":"btn-primary"}},[e("span",[t._v(t._s(t._f("uppercase")(t.$t("payment order"))))])])],1)},r=[],n={data:function(){return{path:this.$route.path}},methods:{isMatch:function(t){return this.path.substring(0,t.length)==t}}},i=n,o=s("2877"),c=Object(o["a"])(i,a,r,!1,null,null,null);e["a"]=c.exports},"7d77":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",[e("breadcrumb",[e("breadcrumb-purchase"),e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/purchase/request"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("purchase request")))+" ")]),e("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t._f("uppercase")(t.$t("create"))))])],1),e("purchase-menu"),e("form",{on:{submit:function(e){return e.preventDefault(),t.onSubmit.apply(null,arguments)}}},[e("div",{staticClass:"row"},[e("p-block",[e("p-block-inner",[e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-6"},[e("h4",[t._v(t._s(t._f("uppercase")(t.$t("purchase request"))))]),e("table",{staticClass:"table table-sm table-bordered"},[e("tr",[e("td",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t._f("uppercase")(t.$t("required date")))+" ")]),e("td",[e("p-date-picker",{attrs:{id:"required-date",name:"required-date",label:t.$t("required date"),errors:t.form.errors.get("required_date")},on:{errors:function(e){return t.form.errors.set("required_date",null)}},model:{value:t.form.required_date,callback:function(e){t.$set(t.form,"required_date",e)},expression:"form.required_date"}})],1)])])]),e("div",{staticClass:"col-sm-6 text-right"},[e("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t._f("uppercase")(t.authUser.tenant_name))+" ")]),t.authUser.branch?[t._v(" "+t._s(t._f("uppercase")(t.authUser.branch.address))+" "),t.authUser.branch.address?e("br"):t._e(),t._v(" "+t._s(t._f("uppercase")(t.authUser.branch.phone))+" "),t.authUser.branch.phone?e("br"):t._e()]:t._e()],2)]),e("hr"),e("point-table",{staticClass:"mt-20"},[e("tr",{attrs:{slot:"p-head"},slot:"p-head"},[e("th",{staticClass:"text-center"},[t._v(" # ")]),e("th",[t._v("Item")]),e("th",[t._v("Notes")]),e("th",[t._v("Quantity")]),e("th",[e("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:function(e){return t.toggleMore()}}},[e("i",{staticClass:"fa fa-ellipsis-h"})])])]),t._l(t.form.items,(function(s,a){return[e("tr",{key:a,attrs:{slot:"p-body"},slot:"p-body"},[e("th",{staticClass:"text-center"},[t._v(" "+t._s(a+1)+" ")]),e("td",[e("span",{staticClass:"select-link",on:{click:function(e){return t.$refs.item.open(a)}}},[t._v(" "+t._s(t._f("uppercase")(s.item_label||t.$t("select")))+" ")])]),e("td",[e("p-form-input",{attrs:{id:"notes",name:"notes",disabled:null==s.item_id},model:{value:s.notes,callback:function(e){t.$set(s,"notes",e)},expression:"row.notes"}})],1),e("td",[e("p-quantity",{attrs:{id:"quantity"+a,name:"quantity"+a,disabled:null==s.item_id,"item-id":s.item_id,units:s.units,unit:{name:s.unit,label:s.unit,converter:s.converter}},on:{choosen:function(e){return t.chooseUnit(e,s)}},model:{value:s.quantity,callback:function(e){t.$set(s,"quantity",e)},expression:"row.quantity"}})],1),e("td",[t.isSaving?t._e():e("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:function(t){s.more=!s.more}}},[e("i",{staticClass:"fa fa-ellipsis-h"})])])]),s.more&&s.item_id?[e("tr",{key:"ext-"+a,staticClass:"bg-gray-light",attrs:{slot:"p-body"},slot:"p-body"},[e("th",{staticClass:"bg-gray-light"}),e("td",{attrs:{colspan:"3"}},[e("p-form-row",{attrs:{id:"allocation",name:"allocation",label:t.$t("allocation")}},[e("div",{staticClass:"col-lg-9 mt-5",attrs:{slot:"body"},slot:"body"},[e("span",{staticClass:"select-link",on:{click:function(e){return t.$refs.allocation.open(a)}}},[t._v(" "+t._s(t._f("uppercase")(s.allocation_name||t.$t("select")))+" ")])])])],1),e("td")])]:t._e()]}))],2),e("div",{staticClass:"row mt-50"},[e("div",{staticClass:"col-sm-6"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.notes,expression:"form.notes"}],staticClass:"form-control",attrs:{rows:"5",placeholder:"Notes"},domProps:{value:t.form.notes},on:{input:function(e){e.target.composing||t.$set(t.form,"notes",e.target.value)}}}),t._v(" "),e("div",{staticClass:"d-sm-block d-md-none mt-10"})]),e("div",{staticClass:"col-sm-3 text-center"},[e("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t._f("uppercase")(t.$t("requested by")))+" ")]),e("div",{staticClass:"mb-50",staticStyle:{"font-size":"11px"}},[t._v(" "+t._s(t._f("dateFormat")(Date.now(),"DD MMMM YYYY"))+" ")]),t._v(" "+t._s(t._f("uppercase")(t.requestedBy))+" "),e("div",{staticClass:"d-sm-block d-md-none mt-10"})]),e("div",{staticClass:"col-sm-3 text-center"},[e("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t._f("uppercase")(t.$t("approved by")))+" ")]),e("div",{staticClass:"mb-50",staticStyle:{"font-size":"11px"}},[t._v(" _______________ ")]),e("span",{staticClass:"select-link",on:{click:function(e){return t.$refs.approver.open()}}},[t._v(t._s(t._f("uppercase")(t.form.approver_name||t.$t("select"))))]),e("br"),e("span",{staticStyle:{"font-size":"9px"}},[t._v(t._s(t._f("uppercase")(t.form.approver_email)))])]),e("div",{staticClass:"col-sm-12"},[e("hr"),e("button",{staticClass:"btn btn-sm btn-primary",attrs:{type:"submit",disabled:t.isSaving}},[e("i",{directives:[{name:"show",rawName:"v-show",value:t.isSaving,expression:"isSaving"}],staticClass:"fa fa-asterisk fa-spin"}),t._v(" "+t._s(t._f("uppercase")(t.$t("save")))+" ")])])])],1)],1)],1)]),e("m-item",{ref:"item",on:{choosen:function(e){return t.chooseItem(e)}}}),e("m-user",{ref:"approver",attrs:{permission:"approve purchase request"},on:{choosen:function(e){return t.chooseApprover(e)}}}),e("m-allocation",{ref:"allocation",on:{choosen:function(e){return t.chooseAllocation(e)}}})],1)},r=[],n=s("5530"),i=(s("14d9"),s("d3b7"),s("159b"),s("4de4"),s("b0c0"),s("e9c4"),s("055b")),o=s("5ae6"),c=s("861c"),l=s("b7ae"),u=s("feee"),m=s("2f62"),p={components:{PurchaseMenu:i["a"],PointTable:u["a"],Breadcrumb:o["a"],BreadcrumbPurchase:c["a"]},data:function(){return{isSaving:!1,requestedBy:localStorage.getItem("fullName"),totalPrice:0,form:new l["a"]({increment_group:this.$moment().format("YYYYMM"),date:this.$moment().format("YYYY-MM-DD HH:mm:ss"),required_date:this.$moment().format("YYYY-MM-DD HH:mm:ss"),request_approval_to:null,approver_name:null,approver_email:null,notes:null,items:[]})}},computed:Object(n["a"])(Object(n["a"])({},Object(m["c"])("purchaseRequest",["purchaseRequest"])),Object(m["c"])("auth",["authUser"])),created:function(){this.addItemRow()},methods:Object(n["a"])(Object(n["a"])({},Object(m["b"])("purchaseRequest",["create"])),{},{addItemRow:function(){this.form.items.push({item_id:null,item_name:null,unit:null,converter:null,quantity:null,allocation_id:null,allocation_name:null,notes:null,more:!1,units:[{label:"",name:"",converter:null}]})},toggleMore:function(){var t=this.form.items.some((function(t,e){return!1===t.more}));this.form.items.forEach((function(e){e.more=t}))},calculate:function(){var t=this;this.totalPrice=0,this.form.items.forEach((function(e){e.price&&(t.totalPrice+=parseFloat(e.price))}))},chooseApprover:function(t){this.form.request_approval_to=t.id,this.form.approver_name=t.fullName,this.form.approver_email=t.email},clearItem:function(t){t.item_id=null,t.item_name=null,t.item_label=null,t.unit=null,t.converter=null,t.quantity=null,t.price=null,t.allocation_id=null,t.notes=null,t.more=!1,t.units=[],this.form.items.length>1&&(this.form.items=this.form.items.filter((function(t){return null!==t.item_id})),this.addItemRow())},chooseAllocation:function(t){var e=this.form.items[t.index];e.allocation_id=t.id,e.allocation_name=t.name},chooseItem:function(t){var e=this.form.items[t.index];if(null==t.id)this.clearItem(e);else{e.item_id=t.id,e.item_name=t.name,e.item_label=t.label,e.units=t.units,e.units.forEach((function(s,a){s.id==t.unit_default_purchase&&(e.unit=s.label,e.converter=s.converter)}));var s=!0;this.form.items.forEach((function(t){null==t.item_id&&(s=!1)})),s&&this.addItemRow()}},chooseUnit:function(t,e){e.unit=t.label,e.converter=t.converter},onSubmit:function(){var t=this;if(this.isSaving=!0,null==this.form.request_approval_to)return this.$notification.error("approval cannot be null"),this.isSaving=!1,void this.form.errors.record({request_approval_to:["Approver should not empty"]});this.form.increment_group=this.$moment(this.form.date).format("YYYYMM"),this.form.items.length>1&&(this.form.items=this.form.items.filter((function(t){return null!==t.item_id}))),this.create(this.form).then((function(e){t.isSaving=!1,t.$notification.success("create success"),Object.assign(t.$data,t.$options.data.call(t)),t.$router.push("/purchase/request/"+e.data.id)})).catch((function(e){t.isSaving=!1;var s="";e.errors&&(s='<pre class="text-left">'+JSON.stringify(e.errors,null,2)+"</pre>"),t.$alert.error("Error Message",e.message+s),t.form.errors.record(e.errors)}))}})},d=p,f=s("2877"),_=Object(f["a"])(d,a,r,!1,null,null,null);e["default"]=_.exports},"861c":function(t,e,s){"use strict";var a=function(){var t=this,e=t._self._c;return e("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/purchase"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("purchase")))+" ")])},r=[],n=s("2877"),i={},o=Object(n["a"])(i,a,r,!1,null,null,null);e["a"]=o.exports}}]);
//# sourceMappingURL=chunk-38372501.42248bfa.js.map
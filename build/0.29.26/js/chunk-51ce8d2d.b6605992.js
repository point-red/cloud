(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51ce8d2d"],{"208e":function(t,s,e){"use strict";var a=function(){var t=this,s=t._self._c;return s("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/sales"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("sales")))+" ")])},o=[],i=e("2877"),n={},r=Object(i["a"])(n,a,o,!1,null,null,null);s["a"]=r.exports},e994:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t._self._c;return s("div",[t.salesQuotation?s("breadcrumb",[s("breadcrumb-sales"),s("router-link",{staticClass:"breadcrumb-item",attrs:{to:"/sales/quotation"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("sales quotation")))+" ")]),s("span",{staticClass:"breadcrumb-item active"},[t._v(t._s(t._f("uppercase")(t.salesQuotation.form.number)))])],1):t._e(),s("sales-menu"),s("p-show-form-approval-status",{attrs:{"is-loading":t.isLoading,"approved-by":t.salesQuotation.form.request_approval_to.full_name,"cancellation-status":t.salesQuotation.form.cancellation_status,"approval-status":t.salesQuotation.form.approval_status,"approval-reason":t.salesQuotation.form.approval_reason},on:{onApprove:t.onApprove,onReject:t.onReject}}),s("p-show-form-cancellation-status",{attrs:{"is-loading":t.isLoading,"cancellation-status":t.salesQuotation.form.cancellation_status,"cancellation-approval-reason":t.salesQuotation.form.cancellation_approval_reason,"request-cancellation-reason":t.salesQuotation.form.request_cancellation_reason},on:{onCancellationApprove:t.onCancellationApprove,onCancellationReject:t.onCancellationReject}}),t.salesQuotation?s("div",{staticClass:"row"},[s("p-block",[s("p-block-inner",{attrs:{"is-loading":t.isLoading}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-12"},[s("div",{staticClass:"text-right"},[s("router-link",{staticClass:"btn btn-sm btn-outline-secondary mr-5",attrs:{to:{name:"sales.quotation.create"}}},[t._v(" "+t._s(t._f("uppercase")(t.$t("create")))+" ")]),s("router-link",{staticClass:"btn btn-sm btn-outline-secondary mr-5",attrs:{to:{name:"sales.quotation.edit",params:{id:t.salesQuotation.id}}}},[t._v(" "+t._s(t._f("uppercase")(t.$t("edit")))+" ")]),null==t.salesQuotation.form.cancellation_status||-1==t.salesQuotation.form.cancellation_status?s("button",{staticClass:"btn btn-sm btn-outline-secondary mr-5",on:{click:function(s){return t.$refs.formRequestDelete.open()}}},[t._v(" "+t._s(t._f("uppercase")(t.$t("delete")))+" ")]):t._e(),s("m-form-request-delete",{ref:"formRequestDelete",on:{delete:function(s){return t.onDelete(s)}}})],1)])]),s("hr"),s("div",{staticClass:"row"},[s("div",{staticClass:"col-sm-6"},[s("h4",[t._v(t._s(t._f("uppercase")(t.$t("sales quotation"))))]),s("table",{staticClass:"table table-sm table-bordered"},[s("tr",[s("td",{staticClass:"font-weight-bold",attrs:{width:"150px"}},[t._v(" "+t._s(t._f("uppercase")(t.$t("form number")))+" ")]),s("td",[t._v(t._s(t.salesQuotation.form.number))])]),s("tr",[s("td",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t._f("uppercase")(t.$t("date")))+" ")]),s("td",[t._v(t._s(t._f("dateFormat")(t.salesQuotation.date,"DD MMMM YYYY")))])]),t.salesQuotation.sales_request?s("tr",[s("td",{staticClass:"font-weight-bold"},[t._v(" "+t._s(t._f("uppercase")(t.$t("reference")))+" ")]),s("td",[t._v(t._s(t.salesQuotation.sales_request.form.number))])]):t._e()])]),s("div",{staticClass:"col-sm-6 text-right"},[s("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t._f("uppercase")(t.authUser.tenant_name))+" ")]),t.salesQuotation.form.branch?[t._v(" "+t._s(t._f("uppercase")(t.salesQuotation.form.branch.address))+" "),t.salesQuotation.form.branch.address?s("br"):t._e(),t._v(" "+t._s(t._f("uppercase")(t.salesQuotation.form.branch.phone))+" "),t.salesQuotation.form.branch.phone?s("br"):t._e()]:t._e(),s("h6",{staticClass:"mt-30 mb-0"},[t._v(" "+t._s(t._f("uppercase")(t.$t("customer")))+" "+t._s(t._f("uppercase")(t.salesQuotation.customer_name))+" ")]),t.salesQuotation.form.customer_address?s("div",[s("i",{staticClass:"fa fa-home fa-fw"}),t._v(" "+t._s(t._f("uppercase")(t.salesQuotation.form.customer_address))+" ")]):t._e(),t.salesQuotation.form.customer_phone?s("div",[s("i",{staticClass:"fa fa-phone fa-fw"}),t._v(" "+t._s(t._f("uppercase")(t.salesQuotation.form.customer_phone))+" ")]):t._e()],2)]),s("hr"),s("point-table",{staticClass:"mt-20"},[s("tr",{attrs:{slot:"p-head"},slot:"p-head"},[s("th",{staticClass:"text-center"},[t._v(" # ")]),s("th",[t._v("Item")]),s("th",{staticClass:"text-right"},[t._v(" Quantity ")]),s("th",{staticClass:"text-right"},[t._v(" Price ")]),s("th",{staticClass:"text-right"},[t._v(" Discount ")]),s("th",{staticClass:"text-right"},[t._v(" Total ")]),s("th",{attrs:{width:"50px"}},[s("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:function(s){return t.toggleMore()}}},[s("i",{staticClass:"fa fa-ellipsis-h"})])])]),t._l(t.salesQuotation.items,(function(e,a){return[s("tr",{key:a,attrs:{slot:"p-body"},slot:"p-body"},[s("th",{staticClass:"text-center"},[t._v(" "+t._s(a+1)+" ")]),s("td",[t._v(t._s(e.item?e.item.label:""))]),s("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("numberFormat")(e.quantity))+" "+t._s(e.unit)+" ")]),s("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("numberFormat")(e.price))+" ")]),s("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("numberFormat")(e.discount_value))+" ")]),s("td",{staticClass:"text-right"},[t._v(" "+t._s(t._f("numberFormat")(e.quantity*(e.price-e.discount_value)))+" ")]),s("td",[s("button",{staticClass:"btn btn-sm btn-outline-secondary",attrs:{type:"button"},on:{click:function(t){e.more=!e.more}}},[s("i",{staticClass:"fa fa-ellipsis-h"})])])]),e.more?[s("tr",{key:"ext2-"+a,staticClass:"bg-gray-light",attrs:{slot:"p-body"},slot:"p-body"},[s("th",{staticClass:"bg-gray-light"}),s("td",{attrs:{colspan:"6"}},[s("p-form-row",{staticClass:"mb-0",attrs:{id:"notes-"+a,name:"notes-"+a,label:t.$t("notes")}},[s("div",{staticClass:"mt-5",attrs:{slot:"body"},slot:"body"},[t._v(" "+t._s(e.notes)+" ")])])],1)])]:t._e()]})),s("tr",{attrs:{slot:"p-body"},slot:"p-body"},[s("th"),s("td"),s("td"),s("td"),s("td",{staticClass:"text-right"},[s("b",[t._v(t._s(t._f("uppercase")(t.$t("total"))))])]),s("td",{staticClass:"text-right"},[s("b",[t._v(t._s(t._f("numberFormat")(t.salesQuotation.subtotal)))])]),s("td")])],2),s("div",{staticClass:"row mt-50"},[s("div",{staticClass:"col-sm-6"},[s("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t._f("uppercase")(t.$t("notes")))+" ")]),s("div",{staticStyle:{"white-space":"pre-wrap"}},[t._v(" "+t._s(t.salesQuotation.form.notes)+" ")]),s("div",{staticClass:"d-sm-block d-md-none mt-10"})]),s("div",{staticClass:"col-sm-3 text-center"},[s("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t._f("uppercase")(t.$t("requested by")))+" ")]),s("div",{staticClass:"mb-50",staticStyle:{"font-size":"11px"}},[t._v(" "+t._s(t._f("dateFormat")(t.salesQuotation.form.date,"DD MMMM YYYY"))+" ")]),t._v(" "+t._s(t._f("uppercase")(t.salesQuotation.form.created_by.full_name))+" "),s("div",{staticClass:"d-sm-block d-md-none mt-10"})]),s("div",{staticClass:"col-sm-3 text-center"},[s("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t._f("uppercase")(t.$t("approved by")))+" ")]),s("div",{staticClass:"mb-50",staticStyle:{"font-size":"11px"}},[t.salesQuotation.form.approval_at?[t._v(" "+t._s(t._f("dateFormat")(t.salesQuotation.form.approval_at,"DD MMMM YYYY"))+" ")]:[t._v(" _______________ ")]],2),t._v(" "+t._s(t._f("uppercase")(t.salesQuotation.form.request_approval_to.full_name))+" "),s("div",{staticStyle:{"font-size":"11px"}},[t._v(" "+t._s(t._f("lowercase")(t.salesQuotation.form.request_approval_to.email))+" ")])])])],1)],1)],1):t._e(),s("m-form-request-delete",{ref:"formRequestDelete",on:{delete:function(s){return t.onDelete(s)}}})],1)},o=[],i=e("5530"),n=(e("d3b7"),e("159b"),e("7db0"),e("14d9"),e("bea4")),r=e("5ae6"),l=e("208e"),c=e("feee"),u=e("2f62"),_={components:{SalesMenu:n["a"],Breadcrumb:r["a"],BreadcrumbSales:l["a"],PointTable:c["a"]},data:function(){return{id:this.$route.params.id,isLoading:!1,isDeleting:!1}},computed:Object(i["a"])(Object(i["a"])({},Object(u["c"])("salesQuotation",["salesQuotation"])),Object(u["c"])("auth",["authUser"])),watch:{$route:function(t,s){t.params.id!=s.params.id&&(this.id=t.params.id,this.salesQuotationRequest())}},created:function(){this.salesQuotationRequest()},methods:Object(i["a"])(Object(i["a"])({},Object(u["b"])("salesQuotation",{find:"find",delete:"delete",approve:"approve",reject:"reject",cancellationApprove:"cancellationApprove",cancellationReject:"cancellationReject"})),{},{toggleMore:function(){var t=this.salesQuotation.items.some((function(t,s){return!1===t.more}));this.salesQuotation.items.forEach((function(s){s.more=t}))},salesQuotationRequest:function(){var t=this;this.isLoading=!0,this.find({id:this.id,params:{with_archives:!0,with_origin:!0,includes:"customer;items.item;items.allocation;form.createdBy;form.requestApprovalTo;form.branch"}}).then((function(s){t.calculate()})).catch((function(s){t.$notification.error(s.message)})).finally((function(){t.isLoading=!1}))},calculate:function(){var t=0;this.salesQuotation.items.forEach((function(s){s.total=s.quantity*(s.price-s.discount_value),t+=parseFloat(s.total)})),this.salesQuotation.subtotal=t},onDelete:function(t){var s=this;this.isDeleting=!0,this.delete({id:this.id,data:{reason:t}}).then((function(t){s.isDeleting=!1,s.$notification.success("cancel success"),s.salesQuotationRequest()})).catch((function(t){s.isDeleting=!1,s.$notification.error(t.message),s.form.errors.record(t.errors)}))},onApprove:function(){var t=this;this.approve({id:this.id}).then((function(s){t.$notification.success("approve success"),t.salesQuotationRequest()}))},onReject:function(t){var s=this;this.reject({id:this.id,reason:t}).then((function(t){s.$notification.success("reject success"),s.salesQuotationRequest()}))},onCancellationApprove:function(){var t=this;this.cancellationApprove({id:this.id}).then((function(s){t.$notification.success("cancellation approved"),t.$router.push("/sales/quotation")}))},onCancellationReject:function(t){var s=this;this.cancellationReject({id:this.id,reason:t}).then((function(t){s.$notification.success("cancellation rejected"),s.salesQuotationRequest()})).catch((function(t){console.log(t.message)}))}})},p=_,d=e("2877"),f=Object(d["a"])(p,a,o,!1,null,null,null);s["default"]=f.exports}}]);
//# sourceMappingURL=chunk-51ce8d2d.b6605992.js.map